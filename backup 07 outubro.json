[{"id":"ac75f203.32e468","type":"tab","label":"Hidro_IFSP","disabled":false,"info":""},{"id":"d3df83cf.c4d32","type":"tab","label":"Solar IFSP","disabled":false,"info":""},{"id":"8a6aa23e.739d6","type":"tab","label":"Solar IFSP_old2","disabled":true,"info":""},{"id":"16e99f25.5d4b19","type":"tab","label":"Registro_mysql","disabled":false,"info":""},{"id":"150a0205.bcdd1e","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"e69ba7ab.add3d8","type":"tab","label":"Meter_eletric_Chaves","disabled":false,"info":""},{"id":"d937f84f.6cd9f8","type":"tab","label":"Flow 2","disabled":false,"info":""},{"id":"9819de8a.09635","type":"mqtt-broker","name":"mqtt_chaves","broker":"avrchaves.duckdns.org","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"c2cc0b83.f9776","type":"ui_group","name":"Hidrômetro","tab":"dcfe8fac.3ef7b8","order":2,"disp":true,"width":9,"collapse":false},{"id":"2bc52c51.dbbb94","type":"mqtt-broker","name":"mqtt_local","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"dcfe8fac.3ef7b8","type":"ui_tab","name":"IFSP Catanduva","icon":"login","order":1,"disabled":false,"hidden":false},{"id":"48b668d7.7949f","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"f867ae9f.52f4c8","type":"ui_group","name":"Registros","tab":"dcfe8fac.3ef7b8","order":3,"disp":true,"width":"14","collapse":false},{"id":"e8a9bac4.db3d18","type":"ui_group","name":"Hidrometro","tab":"ccdfe276.d1db28","order":2,"disp":true,"width":14,"collapse":false},{"id":"6734e116.b19838","type":"ui_group","name":"Painel Solar","tab":"ccdfe276.d1db28","order":3,"disp":true,"width":"11","collapse":false},{"id":"68bf2bf.0b2d1d4","type":"MySQLdatabase","name":"data_sensor_server_ifsp","host":"localhost","port":"3306","db":"sensor","tz":"Brazil/East","charset":"UTF8"},{"id":"ccdfe276.d1db28","type":"ui_tab","name":"Casa","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"9f00e777.185178","type":"ui_spacer","z":"16e99f25.5d4b19","name":"spacer","group":"c2cc0b83.f9776","order":2,"width":3,"height":1},{"id":"757a6e1f.1545a8","type":"ui_spacer","z":"16e99f25.5d4b19","name":"spacer","group":"c2cc0b83.f9776","order":4,"width":3,"height":1},{"id":"1210df91.c720b8","type":"ui_spacer","z":"16e99f25.5d4b19","name":"spacer","group":"c2cc0b83.f9776","order":8,"width":6,"height":1},{"id":"aca69a60.ae7968","type":"ui_spacer","z":"16e99f25.5d4b19","name":"spacer","group":"c2cc0b83.f9776","order":9,"width":6,"height":1},{"id":"a839e467.aaa5f8","type":"mqtt-broker","name":"Mqtthidrometro","broker":"ifhidrometro.duckdns.org","port":"1883","clientid":"","usetls":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"bcd4d8f2.a53d68","type":"mqtt-broker","name":"","broker":"avrchaves.duckdns.org","port":"1883","clientid":"","usetls":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"7d2d7427.2def14","type":"ui_group","name":"Sensor","tab":"a4cf6628.6e676","order":1,"disp":true,"width":"6","collapse":false},{"id":"3ca8e4a6.5e919c","type":"ui_group","name":"Elétrica_Consumo","tab":"ccdfe276.d1db28","order":4,"disp":true,"width":"6","collapse":false},{"id":"a4cf6628.6e676","type":"ui_tab","name":"FreeRtos","icon":"dashboard","order":6,"disabled":false,"hidden":false},{"id":"9bd5b51.93f96c8","type":"MySQLdatabase","name":"data_casa","host":"localhost","port":"3306","db":"casas","tz":"Brazil/East","charset":"UTF8"},{"id":"816beda9.4c1558","type":"ui_group","name":"Elétrica Graficos Consumo","tab":"ccdfe276.d1db28","order":1,"disp":true,"width":14,"collapse":false},{"id":"8f08e849.547418","type":"ui_group","name":"Thermocouple","tab":"c4f82725.5cb928","order":1,"disp":false,"width":"24","collapse":false},{"id":"a2478662.b4c238","type":"ui_group","name":"Thermocouple","tab":"298badf6.a6a0a2","order":1,"disp":false,"width":"12","collapse":false},{"id":"c4f82725.5cb928","type":"ui_tab","name":"History","icon":"dashboard"},{"id":"298badf6.a6a0a2","type":"ui_tab","name":"Current","icon":"dashboard"},{"id":"61d2dced.3db8f4","type":"ui_group","name":"flowtest","tab":"3c94630c.13381c","order":1,"disp":true,"width":22,"collapse":false},{"id":"3c94630c.13381c","type":"ui_tab","name":"Test","icon":"dashboard","order":9},{"id":"d2aa0884.6191","type":"mqtt in","z":"ac75f203.32e468","name":"send/tele/hidroifspctd/SENSOR","topic":"tele/hidroifspctd/SENSOR","qos":"2","datatype":"auto","broker":"9819de8a.09635","x":390,"y":260,"wires":[["fa8a3da0.50a13","95f55bdf.5f3a1"]]},{"id":"416d4161.735788","type":"ui_gauge","z":"ac75f203.32e468","name":"","group":"c2cc0b83.f9776","order":7,"width":3,"height":2,"gtype":"donut","title":"Atualizado há","label":"seg.","format":"{{value}}","min":"0","max":"30","colors":["#008000","#ffff00","#ff0000"],"seg1":"","seg2":"","x":1000,"y":400,"wires":[]},{"id":"95f55bdf.5f3a1","type":"function","z":"ac75f203.32e468","name":"DET-01 - broker Updated since","func":"//call constructor Date() and pass to now\nvar now = new Date();\n//time_now receive current time\nvar time_now = now.getTime();\n\nif (typeof last_broker_time === 'undefined'){\n    last_broker_time = time_now;\n}\n\nif (msg.payload){\n    last_broker_time = time_now;\n    } \n\n//1. diference between times\n//2. divide per 1000 to parse miliseconds to second\n//3. divide per 60 to parse second to minute\n//4. .toFixed(0) return an int value\n//5. parseInt(\"string\",10) --> returns a decimal value based on own string value\nvar difference_between_times = parseInt(((time_now - last_broker_time)/1000).toFixed(0),10);\n\n//pass to msg.payload the desire velue to show on gauge in dashboard\nmsg.payload = difference_between_times; \nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":690,"y":400,"wires":[["416d4161.735788"]]},{"id":"4945e62.64d1118","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload","v":"msg.time_sample","vt":"global"},{"p":"topic","v":"","vt":"string"}],"repeat":"5","crontab":"","once":false,"topic":"","payload":"msg.time_sample","payloadType":"global","x":390,"y":400,"wires":[["95f55bdf.5f3a1"]]},{"id":"8a7139f.8d3ac48","type":"function","z":"ac75f203.32e468","name":"String_To_number","func":"var C1 = { payload: msg.payload.COUNTER.C1 }\n\nvar C2 = { payload: msg.payload.COUNTER.C2 }\nC2.payload = (C2.payload/420)-4092; \nC2.payload = C2.payload.toFixed(1)\nvar formatedNumber = parseFloat(C2.payload)\n\nglobal.set(\"horta\", formatedNumber );\n\nglobal.set(\"entrada\", C1.payload);\n\n\nreturn [ C1, C2 ];\n\n//1 600 000\n//   97 973","outputs":2,"noerr":0,"initialize":"","finalize":"","x":770,"y":260,"wires":[["ed6ac3dc.1c3f3","4a73a576.3fcdbc"],["8460275e.ff617","3f8331f8.2235ae"]]},{"id":"ea0a9e0b.ed9a6","type":"debug","z":"ac75f203.32e468","name":"contador","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":700,"y":180,"wires":[]},{"id":"fa8a3da0.50a13","type":"json","z":"ac75f203.32e468","name":"","property":"payload","action":"","pretty":true,"x":590,"y":260,"wires":[["8a7139f.8d3ac48","ea0a9e0b.ed9a6"]]},{"id":"ed6ac3dc.1c3f3","type":"ui_text","z":"ac75f203.32e468","group":"c2cc0b83.f9776","order":1,"width":6,"height":1,"name":"","label":"Entrada","format":"{{msg.payload}} litros","layout":"row-left","x":980,"y":160,"wires":[]},{"id":"4a73a576.3fcdbc","type":"ui_chart","z":"ac75f203.32e468","name":"","group":"c2cc0b83.f9776","order":5,"width":9,"height":4,"label":"Entrada (litros)","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":1000,"y":200,"wires":[[]]},{"id":"8460275e.ff617","type":"ui_chart","z":"ac75f203.32e468","name":"horta grafico","group":"c2cc0b83.f9776","order":6,"width":9,"height":5,"label":"Horta (litros) Desde 14/06","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":990,"y":260,"wires":[[]]},{"id":"3f8331f8.2235ae","type":"ui_text","z":"ac75f203.32e468","group":"c2cc0b83.f9776","order":3,"width":6,"height":1,"name":"horta text","label":"Horta","format":"{{msg.payload}}  (litros) desde 14/06","layout":"row-left","x":980,"y":300,"wires":[]},{"id":"a3024444.07fc18","type":"comment","z":"ac75f203.32e468","name":"","info":"Banco de Dados - Mysql","x":170,"y":720,"wires":[]},{"id":"6ae82af1.ae4904","type":"comment","z":"ac75f203.32e468","name":"Manutenção","info":"","x":180,"y":1120,"wires":[]},{"id":"da425180.07f5f","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/hidroifspctd/counter2","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":360,"y":1300,"wires":[]},{"id":"4ce6b08d.b89f","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"97973","payloadType":"num","x":150,"y":1300,"wires":[["da425180.07f5f"]]},{"id":"2f7c71a9.644fae","type":"comment","z":"ac75f203.32e468","name":"coloca contador em um numero","info":"","x":190,"y":1180,"wires":[]},{"id":"1b40116a.0a9c37","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/hidroifspctd/counter1","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":360,"y":1240,"wires":[]},{"id":"dea7b73c.eb93f","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"9094","payloadType":"num","x":150,"y":1240,"wires":[["1b40116a.0a9c37"]]},{"id":"add7be36.6b066","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/tasmota_hidro/rule3","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":380,"y":1560,"wires":[]},{"id":"e3d59538.8a5f5","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"false","payloadType":"bool","x":170,"y":1560,"wires":[["add7be36.6b066"]]},{"id":"4e1788f8.ba7dd","type":"comment","z":"ac75f203.32e468","name":"comandos remoto mqtt","info":"","x":230,"y":1520,"wires":[]},{"id":"cc3675c5.7333d","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/tasmota_hidro/rule3","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":380,"y":1620,"wires":[]},{"id":"1060af0.474f751","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"num","x":170,"y":1620,"wires":[["cc3675c5.7333d"]]},{"id":"511c6a4c.66d9c4","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/tasmota_hidro/rule3","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":380,"y":1680,"wires":[]},{"id":"c620ad91.03d7d8","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"num","x":170,"y":1680,"wires":[["511c6a4c.66d9c4"]]},{"id":"da0bbd0a.f8d4b8","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/hidroifspctd/CounterDebounce","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":410,"y":1740,"wires":[]},{"id":"d9ab976e.47b27","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"0","payloadType":"num","x":170,"y":1740,"wires":[["da0bbd0a.f8d4b8"]]},{"id":"830c5cac.0d3568","type":"mqtt out","z":"ac75f203.32e468","d":true,"name":"","topic":"cmnd/hidroifspctd/restart","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":370,"y":1800,"wires":[]},{"id":"ee739a0b.496408","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"1","payloadType":"num","x":170,"y":1800,"wires":[["830c5cac.0d3568"]]},{"id":"13334f67.3eea29","type":"mqtt out","z":"ac75f203.32e468","name":"","topic":"cmnd/hidroifspctd/Backlog Template","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":410,"y":1460,"wires":[]},{"id":"2db539c2.da6116","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"","payloadType":"num","x":150,"y":1460,"wires":[["13334f67.3eea29"]]},{"id":"df5f7577.5ad498","type":"mqtt out","z":"ac75f203.32e468","name":"","topic":"cmnd/tasmotacasa/Backlog ","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":380,"y":1400,"wires":[]},{"id":"91c82eda.cf5b4","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"Template","payloadType":"str","x":150,"y":1400,"wires":[["df5f7577.5ad498"]]},{"id":"d9a042e7.6fb2","type":"mqtt out","z":"ac75f203.32e468","name":"","topic":"cmnd/hidroifspctd/TelePeriod","qos":"1","retain":"","broker":"2bc52c51.dbbb94","x":390,"y":1860,"wires":[]},{"id":"2f1aa532.00b7d2","type":"inject","z":"ac75f203.32e468","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"30","payloadType":"num","x":170,"y":1860,"wires":[["d9a042e7.6fb2"]]},{"id":"aa3ccb.4b7bab38","type":"debug","z":"16e99f25.5d4b19","name":"resultado walter_ifsp_msyql","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1380,"y":140,"wires":[]},{"id":"8d35d9a.ba04c28","type":"inject","z":"16e99f25.5d4b19","name":"10min","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":200,"wires":[["4f86b420.b16d44"]]},{"id":"b34edb19.bb638","type":"function","z":"16e99f25.5d4b19","name":"INSERT","func":"\nvar entrada =  global.get(\"entrada\");\nvar  horta = global.get(\"horta\");\nvar  diferencaentrada = global.get(\"diferencaentrada\");\nvar  diferencahorta = global.get(\"diferencahorta\"); \n\n\n\nmsg.topic = \"INSERT INTO hidrometro_ifsp (entrada, horta, dif_entrada, dif_horta) VALUES (\"+entrada+\",\"+horta+\",\"+diferencaentrada+\", \"+diferencahorta+\");\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":140,"wires":[["782f31d1.7399b8"]]},{"id":"779d28b7.5c2278","type":"inject","z":"16e99f25.5d4b19","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":400,"wires":[["562e41dc.d368b8"]]},{"id":"562e41dc.d368b8","type":"function","z":"16e99f25.5d4b19","name":"SELECT","func":"msg.topic = \"SELECT entrada as entrada, horta as horta, time as time FROM  hidrometro_ifsp order by time DESC limit 500;\";\n\nreturn msg;\n\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":400,"wires":[["9704d3c.56cbe3"]]},{"id":"c451ed84.e27458","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":250,"y":360,"wires":[]},{"id":"750746cf.741c28","type":"change","z":"16e99f25.5d4b19","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t    {  \"label\": \"entrada  (L)\", \"field\": \"entrada\" },\t    {  \"label\": \"horta  (L)\", \"field\": \"horta\" }\t\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":400,"wires":[["f5b42326.c6aaa","43483ba4.cdb354"]]},{"id":"f5b42326.c6aaa","type":"ui_chart","z":"16e99f25.5d4b19","name":"Consumo água","group":"c2cc0b83.f9776","order":1,"width":14,"height":9,"label":"Consumo água","chartType":"line","legend":"true","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":890,"y":400,"wires":[[]]},{"id":"2818bd3b.584ca2","type":"comment","z":"16e99f25.5d4b19","name":"Grava Hidrometro em mysql","info":"","x":200,"y":100,"wires":[]},{"id":"e8b02d57.5158b","type":"inject","z":"16e99f25.5d4b19","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":540,"wires":[["2fbeff2e.69d028"]]},{"id":"2fbeff2e.69d028","type":"function","z":"16e99f25.5d4b19","name":"SELECT","func":"msg.topic = \"SELECT entrada as entrada, horta as horta, time as time FROM  hidrometro_ifsp order by time DESC limit 10;\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":540,"wires":[["ff0550d.83d01b"]]},{"id":"52e7d0f9.bf2f38","type":"ui_template","z":"16e99f25.5d4b19","group":"f867ae9f.52f4c8","name":"Tabela com style","order":1,"width":14,"height":10,"format":"<div layout=\"row\" layout-align=\"start center\">\n  <span flex>Hora</span>\n  <span flex>entrada</span>\n  <span flex>horta</span>\n</div>\n<div layout=\"row\" layout-align=\"start center\" ng-repeat=\"row in msg.payload\">\n  <span flex style=\"color: green\">{{row.time}}</span>\n  <span flex style=\"color: red\">{{row.entrada}} </span>\n  <span flex style=\"color: red\">{{row.horta}} </span>\n  \n\n</div>\n ","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":730,"y":540,"wires":[[]]},{"id":"728c723b.3a1364","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":270,"y":460,"wires":[]},{"id":"43483ba4.cdb354","type":"debug","z":"16e99f25.5d4b19","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":860,"y":340,"wires":[]},{"id":"782f31d1.7399b8","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":1140,"y":140,"wires":[["aa3ccb.4b7bab38"]]},{"id":"9704d3c.56cbe3","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":510,"y":400,"wires":[["750746cf.741c28"]]},{"id":"ff0550d.83d01b","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":520,"y":540,"wires":[["52e7d0f9.bf2f38","616ee849.b84dc"]]},{"id":"c74c18a4.fe19","type":"comment","z":"16e99f25.5d4b19","name":"Tabelas_mysql_Hidrometro_IFSP","info":"","x":210,"y":40,"wires":[]},{"id":"f0250c98.c3751","type":"debug","z":"16e99f25.5d4b19","name":"resultado solarmysqlifsp","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1030,"y":740,"wires":[]},{"id":"aab8f614.6c28b8","type":"inject","z":"16e99f25.5d4b19","name":"10min","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/10 6-18 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":200,"y":740,"wires":[["ea9ab106.962008"]]},{"id":"ea9ab106.962008","type":"function","z":"16e99f25.5d4b19","name":"INSERT Dados Globais Solar IFSP ","func":" var potenciacatanduva = global.get(\"potenciacatanduva\"); \nvar producaocatanduva = global.get(\"producaocatanduva\");  \n\n var potenciaaraquara = global.get(\"potenciaararaquara\"); \n var producaoaararaquara = global.get(\"producaoaararaquara\");  \n \n var potenciabarretos = global.get(\"potenciabarretos\"); \n var producaobarretos = global.get(\"producaobarretos\");  \n\n var potenciabirigui = global.get(\"potenciabirigui\"); \n var producaobirigui = global.get(\"producaobirigui\");      \n \n  var potenciamatao = global.get(\"potenciamatao\"); \n var producaomatao = global.get(\"producaomatao\");  \n \n    var potenciaepitacio = global.get(\"potenciaepitacio\"); \n var producaoepitacio = global.get(\"producaoepitacio\"); \n \n   var potenciasertaozinho = global.get(\"potenciasetaozinho\");\n var producaosertaozinho = global.get(\"producaosertaozinho\"); \n \n    var potenciavotuporanga = global.get(\"potenciavotuporanga\"); \n var producaovotuporanga = global.get(\"producaovotuporanga\"); \n \n\nmsg.topic = \"INSERT INTO Solar_IFSP (potenciacatanduva, producaocatanduva, potenciaaraquara, producaoaararaquara, potenciabarretos, producaobarretos, potenciabirigui, producaobirigui, potenciamatao, producaomatao, potenciaepitacio, producaoepitacio, potenciasertaozinho, producaosertaozinho, potenciavotuporanga, producaovotuporanga) VALUES (\"+potenciacatanduva+\", \"+producaocatanduva+\", \"+potenciaaraquara+\", \"+producaoaararaquara+\", \"+potenciabarretos+\", \"+producaobarretos+\", \"+potenciabirigui+\", \"+producaobirigui+\", \"+potenciamatao+\", \"+producaomatao+\", \"+potenciaepitacio+\", \"+producaoepitacio+\", \"+potenciasertaozinho+\", \"+producaosertaozinho+\", \"+potenciavotuporanga+\", \"+producaovotuporanga+\");\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":740,"wires":[["e2cb70c3.edc478"]]},{"id":"4a15b631.3bce68","type":"comment","z":"16e99f25.5d4b19","name":"SOLAR","info":"","x":610,"y":620,"wires":[]},{"id":"e2cb70c3.edc478","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":780,"y":740,"wires":[["f0250c98.c3751"]]},{"id":"616ee849.b84dc","type":"debug","z":"16e99f25.5d4b19","name":"tabela","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":860,"y":600,"wires":[]},{"id":"10c2aeae.6e8ea1","type":"inject","z":"16e99f25.5d4b19","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":860,"wires":[["6e55ecac.d91c44"]]},{"id":"6e55ecac.d91c44","type":"function","z":"16e99f25.5d4b19","name":"SELECT Potencia","func":"msg.topic = \"SELECT potenciacatanduva as potenciacatanduva, potenciaaraquara as potenciaaraquara, time as time FROM  Solar_IFSP order by time DESC limit 10;\";\n\nreturn msg;\n\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":860,"wires":[["f827b4b6.4b6b78"]]},{"id":"c496a0a6.e3622","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":290,"y":820,"wires":[]},{"id":"ef3eceb4.793b4","type":"change","z":"16e99f25.5d4b19","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t    {  \"label\": \"potencia CTC  (W)\", \"field\": \"potenciacatanduva\" },\t    {  \"label\": \"potencia ARQ (W)\", \"field\": \"potenciaaraquara\" }\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":890,"y":860,"wires":[["f61ec45d.703278","a75b999b.3bd66"]]},{"id":"f61ec45d.703278","type":"ui_chart","z":"16e99f25.5d4b19","name":"Solar_Potencia","group":"f867ae9f.52f4c8","order":1,"width":14,"height":9,"label":"Solar_Potencia","chartType":"line","legend":"true","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":1100,"y":860,"wires":[[]]},{"id":"bc07ad4c.3dd5","type":"inject","z":"16e99f25.5d4b19","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":960,"wires":[["164a8cc6.78c6a3"]]},{"id":"164a8cc6.78c6a3","type":"function","z":"16e99f25.5d4b19","name":"SELECT","func":"msg.topic = \"SELECT potenciacatanduva as potencia, producaocatanduva as producao, time as time FROM  Solar_IFSP order by time DESC limit 10;\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":960,"wires":[["8596d3c0.c827a8"]]},{"id":"7d48ebc9.5d0f74","type":"ui_template","z":"16e99f25.5d4b19","group":"f867ae9f.52f4c8","name":"Tabela Solar_producao","order":1,"width":11,"height":10,"format":"<div layout=\"row\" layout-align=\"start center\">\n  <span flex>Hora</span>\n  <span flex>potencia</span>\n  <span flex>producao</span>\n</div>\n<div layout=\"row\" layout-align=\"start center\" ng-repeat=\"row in msg.payload\">\n  <span flex style=\"color: green\">{{row.time}}</span>\n  <span flex style=\"color: red\">{{row.potencia}} </span>\n  <span flex style=\"color: red\">{{row.producao}} </span>\n  \n\n</div>\n ","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":910,"y":1000,"wires":[[]]},{"id":"89046b3.2505418","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":290,"y":920,"wires":[]},{"id":"a75b999b.3bd66","type":"debug","z":"16e99f25.5d4b19","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1110,"y":800,"wires":[]},{"id":"f827b4b6.4b6b78","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":680,"y":860,"wires":[["ef3eceb4.793b4"]]},{"id":"8596d3c0.c827a8","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":600,"y":960,"wires":[["7d48ebc9.5d0f74","2998d586.452d72"]]},{"id":"2998d586.452d72","type":"debug","z":"16e99f25.5d4b19","name":"tabela","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":870,"y":940,"wires":[]},{"id":"915985d2.2861d","type":"inject","z":"16e99f25.5d4b19","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":1120,"wires":[["7b4adad1.7d9a34"]]},{"id":"b94aa654.97f978","type":"function","z":"16e99f25.5d4b19","name":"SELECT consumo","func":"msg.topic = \"select sum(dif_entrada) as consumo, time as time, hour(time) as hora from hidrometro_ifsp WHERE time > date_sub(now(),interval \"+ msg.payload +\") group by cast(time as date),hour(time);\";\n\n\nreturn msg;\n//msg.topic = \"select sum(dif_entrada) as consumo, cast(time as date) as dia, hour(time) as hora from hidrometro_ifsp WHERE time > date_sub(now(),interval \"+ msg.payload +\") group by cast(time as date),hour(time);\";\n\n//msg.topic = \"SELECT dif_entrada as dif_entrada, time as time FROM hidrometro_ifsp WHERE time > date_sub(now(),interval \"+ msg.payload +\");\";\n\n//msg.topic = \"SELECT potenciacatanduva as potenciacatanduva, time as time FROM  Solar_IFSP order by time DESC limit 10;\";\n\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1120,"wires":[["346d2dd4.303c62","e80b06a1.4de78"]]},{"id":"3b3e1a28.bc878e","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":290,"y":1080,"wires":[]},{"id":"628f23e6.9f3e84","type":"debug","z":"16e99f25.5d4b19","name":"potencia catanduva","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1140,"y":1060,"wires":[]},{"id":"346d2dd4.303c62","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":720,"y":1120,"wires":[["f79c8086.740f3"]]},{"id":"1e336ff0.d4c49","type":"comment","z":"16e99f25.5d4b19","name":"Tabelas_mysql_Solar_IFSP","info":"","x":220,"y":680,"wires":[]},{"id":"4f86b420.b16d44","type":"function","z":"16e99f25.5d4b19","name":"SELECT","func":"msg.topic = \"SELECT entrada as entradaanterior, horta as hortaanterior, time as time FROM  hidrometro_ifsp order by time DESC limit 1;\";\n\nreturn msg;\n\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":200,"wires":[["d0ffdc48.46c4b"]]},{"id":"8bbda6a0.0aa45","type":"comment","z":"16e99f25.5d4b19","name":"Mysql: consulta ultimo dado gravado no banco de dados para calcular diferencas de consumo","info":"","x":750,"y":40,"wires":[]},{"id":"d0ffdc48.46c4b","type":"mysql","z":"16e99f25.5d4b19","mydb":"68bf2bf.0b2d1d4","name":"conexao_mysql","x":500,"y":200,"wires":[["145c4f61.146c81"]]},{"id":"145c4f61.146c81","type":"function","z":"16e99f25.5d4b19","name":"String_To_number","func":"\nvar entrada =  global.get(\"entrada\"); \nvar  horta = global.get(\"horta\"); \n\nvar entradaanterior = { payload: msg.payload[0].entradaanterior }\n\nvar hortaanterior = { payload: msg.payload[0].hortaanterior }\n\nvar diferencaentrada = entrada - entradaanterior.payload;\nvar diferencahorta = horta - hortaanterior.payload;\n\n\nentradap =          { payload : entrada };\ndiferencaentradap = { payload : diferencaentrada };\ndiferencahortap =   { payload : diferencahorta };\n\n\nglobal.set(\"diferencaentrada\", diferencaentrada);\nglobal.set(\"diferencahorta\", diferencahorta );\n\nreturn [  entradaanterior, entradap, diferencaentradap, diferencahortap];\n\n","outputs":4,"noerr":0,"initialize":"","finalize":"","x":710,"y":200,"wires":[["f1043946.b49908","b34edb19.bb638"],["f1043946.b49908"],["f1043946.b49908"],["f1043946.b49908"]]},{"id":"f1043946.b49908","type":"debug","z":"16e99f25.5d4b19","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":970,"y":220,"wires":[]},{"id":"f79c8086.740f3","type":"change","z":"16e99f25.5d4b19","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t    {  \"label\": \"Consumo (L)\", \"field\": \"consumo\" },\t    {  \"label\": \"\", \"field\": \"\" }\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":1120,"wires":[["fcab3d29.aba68"]]},{"id":"fcab3d29.aba68","type":"ui_chart","z":"16e99f25.5d4b19","name":"Consumo Entrada (litros)","group":"c2cc0b83.f9776","order":1,"width":14,"height":9,"label":"Consumo Entrada (litros)","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":1170,"y":1120,"wires":[[]]},{"id":"7b4adad1.7d9a34","type":"ui_dropdown","z":"16e99f25.5d4b19","name":"","label":"Time Scale","tooltip":"","place":"2 horas","group":"f867ae9f.52f4c8","order":4,"width":0,"height":0,"passthru":true,"multiple":false,"options":[{"label":"1 hora","value":"1 hour","type":"str"},{"label":"2 horas","value":"2 hour","type":"str"},{"label":"12 horas","value":"12 hour","type":"str"},{"label":"24 horas","value":"1 day","type":"str"},{"label":"2 dias","value":"2 day","type":"str"}],"payload":"","topic":"topic","topicType":"msg","x":310,"y":1120,"wires":[["b94aa654.97f978"]]},{"id":"e80b06a1.4de78","type":"debug","z":"16e99f25.5d4b19","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":760,"y":1280,"wires":[]},{"id":"d5519d23.464c8","type":"http request","z":"8a6aa23e.739d6","name":"login","method":"use","ret":"obj","url":"","tls":"","x":510,"y":100,"wires":[["4898dc83.252ba4"]]},{"id":"9a9e058b.af8c68","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":380,"wires":[["c7d3abae.d0fdc8"]]},{"id":"93303fba.6bd16","type":"http request","z":"8a6aa23e.739d6","name":"get Plant list","method":"use","ret":"obj","url":"","tls":"","x":490,"y":160,"wires":[["26c0fa1.35f9606","55a9ec0e.2ccf14","fb68f31.9fa9b1","5cf3605b.97d91","ceb6d245.2b6da","12b41aae.d24715","9e19594.85750a8","c743296d.ef1ed8"]]},{"id":"4898dc83.252ba4","type":"function","z":"8a6aa23e.739d6","name":"","func":"msg.url='http://myevolvecloud.com/cpro/epc/plantview/view/doPlantList.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":160,"wires":[["93303fba.6bd16"]]},{"id":"9ae88882.e52468","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":700,"y":300,"wires":[["bafe2645.3adc18","3899eb36.d18994","5d12adaf.797d64"]]},{"id":"26c0fa1.35f9606","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[4];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":300,"wires":[["9ae88882.e52468","5d305bdf.d0faf4"]]},{"id":"bafe2645.3adc18","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":380,"wires":[["9a9e058b.af8c68"]]},{"id":"b9068e03.70f07","type":"function","z":"8a6aa23e.739d6","name":"Login Details","func":"msg.url='http://myevolvecloud.com/cpro/login/validateLogin.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['userName']='ifsp.solar@gmail.com';\nmsg.payload['password']='123456';\nmsg.payload['lan'] = '2';\nmsg.payload['domain']='myevolvecloud.com';\nmsg.payload['userType']='C';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":362,"y":62,"wires":[["d5519d23.464c8"]]},{"id":"c26f0b83.6cd518","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Catanduva","info":"data[3]=Catanduva","x":300,"y":300,"wires":[]},{"id":"821601f3.7d5de","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":320,"y":380,"wires":[]},{"id":"218aaac4.c576a6","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":460,"wires":[["3d3d896f.88c4e6"]]},{"id":"3899eb36.d18994","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":460,"wires":[["218aaac4.c576a6"]]},{"id":"e96c3de1.1574e","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":300,"y":460,"wires":[]},{"id":"63159d66.5d3144","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":540,"wires":[["76c1e918.e8ab58"]]},{"id":"5d12adaf.797d64","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":540,"wires":[["63159d66.5d3144"]]},{"id":"4d8d66e7.c70508","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":300,"y":540,"wires":[]},{"id":"c7d3abae.d0fdc8","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":"var mensagens = { payload : msg.inverterData}; \nvar pontenciatotal1 = msg.inverterData.powerTotal;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\nvar producao1 = msg.inverterData.energyToday;\n\nvar unit = { payload :unidade};\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1  };\n\n\nreturn [ pontenciatotal1a, producao1a , mensagens];\n\n\n","outputs":4,"noerr":0,"initialize":"","finalize":"","x":950,"y":380,"wires":[["7d4a6a6d.ef1584","924b774f.0df2f8"],["baba731.ade2f9","924b774f.0df2f8"],["2f1e8d66.054a12"],["924b774f.0df2f8"]]},{"id":"3d3d896f.88c4e6","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal ;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":956,"y":458,"wires":[["a2d0b953.13af38"],["52b94d9.ef55ab4"]]},{"id":"76c1e918.e8ab58","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal ;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":540,"wires":[["631c0d79.aa4734"],["cc0aab85.4933a8"]]},{"id":"7d4a6a6d.ef1584","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":340,"wires":[["f10d6e61.9267f"]]},{"id":"a2d0b953.13af38","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":440,"wires":[["f10d6e61.9267f"]]},{"id":"631c0d79.aa4734","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":540,"wires":[["f10d6e61.9267f"]]},{"id":"f10d6e61.9267f","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":400,"wires":[["62fa47e2.73e148"]]},{"id":"62fa47e2.73e148","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":400,"wires":[["a89e8b7b.58f288"]]},{"id":"baba731.ade2f9","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":380,"wires":[["8043ee93.4526e"]]},{"id":"52b94d9.ef55ab4","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":480,"wires":[["8043ee93.4526e"]]},{"id":"cc0aab85.4933a8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":580,"wires":[["8043ee93.4526e"]]},{"id":"8043ee93.4526e","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":500,"wires":[["9dbd36ab.800848"]]},{"id":"62b8f05e.806da","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":500,"wires":[["d8553176.35467"]]},{"id":"64c2fd0d.0e6244","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":1440,"y":360,"wires":[]},{"id":"acf14d55.6994f","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":1450,"y":460,"wires":[]},{"id":"9dbd36ab.800848","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":500,"wires":[["62b8f05e.806da"]]},{"id":"feeefb9f.4642c8","type":"function","z":"8a6aa23e.739d6","name":"set global_potencia catanduva","func":"global.set(\"potenciacatanduva\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":380,"wires":[[]]},{"id":"d8553176.35467","type":"function","z":"8a6aa23e.739d6","name":"set global_producao catanduva","func":"global.set(\"producaocatanduva\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":460,"wires":[[]]},{"id":"3ca74a34.fc8016","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":800,"wires":[["6737d17b.315d9"]]},{"id":"6fcfb317.0ba48c","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":680,"y":720,"wires":[["336f673.9e31998","4c400f74.36952","48d54743.16c3d8"]]},{"id":"55a9ec0e.2ccf14","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[0];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":720,"wires":[["6fcfb317.0ba48c"]]},{"id":"336f673.9e31998","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":800,"wires":[["3ca74a34.fc8016"]]},{"id":"c0eceb2d.26c748","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta 0 - Araraquara","info":"data[3]=Catanduva","x":270,"y":720,"wires":[]},{"id":"71006f66.43275","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":300,"y":800,"wires":[]},{"id":"8481706b.56d82","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":880,"wires":[["33d1878d.5d69d8"]]},{"id":"4c400f74.36952","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":880,"wires":[["8481706b.56d82"]]},{"id":"f8708661.6ac988","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":280,"y":880,"wires":[]},{"id":"118a794c.63ca77","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":960,"wires":[["d1cbf90a.893f08"]]},{"id":"48d54743.16c3d8","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":960,"wires":[["118a794c.63ca77"]]},{"id":"92aeb198.50979","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":280,"y":960,"wires":[]},{"id":"6737d17b.315d9","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":"var mensagens = { payload : msg.inverterData};\n\nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a , mensagens ];\n\n\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":930,"y":800,"wires":[["411b4746.c176a8"],["7fc8510.25242b"],[]]},{"id":"33d1878d.5d69d8","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":936,"y":878,"wires":[["cf1a5ebf.c636b"],["d22f134b.d27dd"]]},{"id":"d1cbf90a.893f08","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":960,"wires":[["666707d1.664b28"],["85f87ea0.d10bf"]]},{"id":"411b4746.c176a8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":760,"wires":[["f06baeb2.3cdb4"]]},{"id":"cf1a5ebf.c636b","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":860,"wires":[["f06baeb2.3cdb4"]]},{"id":"666707d1.664b28","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":960,"wires":[["f06baeb2.3cdb4"]]},{"id":"f06baeb2.3cdb4","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":820,"wires":[["7001fbcc.aa3124"]]},{"id":"7001fbcc.aa3124","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":820,"wires":[["ac4834fc.10c758"]]},{"id":"7fc8510.25242b","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":800,"wires":[["afa315f1.390488"]]},{"id":"d22f134b.d27dd","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":900,"wires":[["afa315f1.390488"]]},{"id":"85f87ea0.d10bf","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1000,"wires":[["afa315f1.390488"]]},{"id":"afa315f1.390488","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":920,"wires":[["d2eec1ad.0de2"]]},{"id":"771ed8bb.142ef8","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":920,"wires":[["2c0d3c3c.aafa84"]]},{"id":"67e6cd7f.4ef214","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":1420,"y":780,"wires":[]},{"id":"637866e7.9d7e18","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":1430,"y":880,"wires":[]},{"id":"d2eec1ad.0de2","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":920,"wires":[["771ed8bb.142ef8"]]},{"id":"67c859ad.5583d8","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciaararaquara","func":"global.set(\"potenciaararaquara\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":820,"wires":[[]]},{"id":"2c0d3c3c.aafa84","type":"function","z":"8a6aa23e.739d6","name":"set global_producaoaararaquara","func":"global.set(\"producaoaararaquara\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1970,"y":920,"wires":[[]]},{"id":"6dd507b0.53d2a8","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1180,"wires":[["ad55e3fb.bbbc6"]]},{"id":"fa347377.de9bb","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":680,"y":1100,"wires":[["e647ee27.a4895","572674a9.776cec","cd7f890e.2c7998"]]},{"id":"fb68f31.9fa9b1","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[1];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1100,"wires":[["fa347377.de9bb"]]},{"id":"e647ee27.a4895","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1180,"wires":[["6dd507b0.53d2a8"]]},{"id":"6539451a.2b684c","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Barretos","info":"","x":270,"y":1100,"wires":[]},{"id":"ac241c5f.09c96","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":300,"y":1180,"wires":[]},{"id":"af6520cd.40d53","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1260,"wires":[["17fc924f.57485e"]]},{"id":"572674a9.776cec","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1260,"wires":[["af6520cd.40d53"]]},{"id":"d95ae642.5a4138","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":280,"y":1260,"wires":[]},{"id":"92d9b639.b7edf8","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1340,"wires":[["ccdceced.1ea32"]]},{"id":"cd7f890e.2c7998","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1340,"wires":[["92d9b639.b7edf8"]]},{"id":"9d9ecb84.d417d8","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":280,"y":1340,"wires":[]},{"id":"ad55e3fb.bbbc6","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":1180,"wires":[["99e36c85.ed1b9"],["cf15c28f.3311c"]]},{"id":"17fc924f.57485e","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":936,"y":1258,"wires":[["2b420cfd.d00a44"],["531f1e46.83143"]]},{"id":"ccdceced.1ea32","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":1340,"wires":[["5ec1e9d9.62e008"],["49bbcdac.190314"]]},{"id":"99e36c85.ed1b9","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1140,"wires":[["36756888.b6f978"]]},{"id":"2b420cfd.d00a44","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1240,"wires":[["36756888.b6f978"]]},{"id":"5ec1e9d9.62e008","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1340,"wires":[["36756888.b6f978"]]},{"id":"36756888.b6f978","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":1200,"wires":[["bee1fdac.ebaf4"]]},{"id":"bee1fdac.ebaf4","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":1200,"wires":[["14624422.55917c"]]},{"id":"cf15c28f.3311c","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1180,"wires":[["2e2d4a69.e4fc36"]]},{"id":"531f1e46.83143","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1280,"wires":[["2e2d4a69.e4fc36"]]},{"id":"49bbcdac.190314","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1380,"wires":[["2e2d4a69.e4fc36"]]},{"id":"2e2d4a69.e4fc36","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":1300,"wires":[["498cee80.8b408"]]},{"id":"4f805650.de4448","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":1300,"wires":[["aeec06f.250f5f8"]]},{"id":"b90eefb1.8e77a","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":1420,"y":1160,"wires":[]},{"id":"cf685c73.fdd59","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":1430,"y":1260,"wires":[]},{"id":"498cee80.8b408","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":1300,"wires":[["4f805650.de4448"]]},{"id":"7475cfe5.ae074","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciabarretos","func":"global.set(\"potenciabarretos\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":1200,"wires":[[]]},{"id":"aeec06f.250f5f8","type":"function","z":"8a6aa23e.739d6","name":"set global_producaobarretos","func":"global.set(\"producaobarretos\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":1300,"wires":[[]]},{"id":"5199185e.b2b818","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1580,"wires":[["18915b07.6f4af5"]]},{"id":"201026f7.af96aa","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":700,"y":1500,"wires":[["e08b5338.efcc9","5da92b47.b98a74","e2cef35f.31673"]]},{"id":"5cf3605b.97d91","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[2];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1500,"wires":[["201026f7.af96aa"]]},{"id":"e08b5338.efcc9","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1580,"wires":[["5199185e.b2b818"]]},{"id":"1c9b5342.a9e0ed","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Birigui","info":"","x":290,"y":1500,"wires":[]},{"id":"d83ddc48.83069","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":320,"y":1580,"wires":[]},{"id":"261f11c6.4dda3e","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1660,"wires":[["1aa0ac1.4d2af54"]]},{"id":"5da92b47.b98a74","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1660,"wires":[["261f11c6.4dda3e"]]},{"id":"14de14df.bb490b","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":300,"y":1660,"wires":[]},{"id":"599ada22.81e724","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1740,"wires":[["2d744e69.70b212"]]},{"id":"e2cef35f.31673","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1740,"wires":[["599ada22.81e724"]]},{"id":"791c0b85.17e2c4","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":300,"y":1740,"wires":[]},{"id":"18915b07.6f4af5","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":1580,"wires":[["e03a5199.e7cc5"],["dabd8a48.ea9d28"]]},{"id":"1aa0ac1.4d2af54","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":956,"y":1658,"wires":[["9c1f78a3.05e418"],["153048f4.9c1937"]]},{"id":"2d744e69.70b212","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal ;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":1740,"wires":[["e162f93a.ae7968"],["2dd4bbc5.8468b4"]]},{"id":"e03a5199.e7cc5","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1540,"wires":[["488a086c.a6e4d8"]]},{"id":"9c1f78a3.05e418","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1640,"wires":[["488a086c.a6e4d8"]]},{"id":"e162f93a.ae7968","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1740,"wires":[["488a086c.a6e4d8"]]},{"id":"488a086c.a6e4d8","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":1600,"wires":[["b655503f.c595c"]]},{"id":"b655503f.c595c","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":1600,"wires":[["d19f68d3.98e8c8"]]},{"id":"dabd8a48.ea9d28","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1580,"wires":[["ded791cc.88257"]]},{"id":"153048f4.9c1937","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1680,"wires":[["ded791cc.88257"]]},{"id":"2dd4bbc5.8468b4","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1780,"wires":[["ded791cc.88257"]]},{"id":"ded791cc.88257","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":1700,"wires":[["a28822e3.9db4c"]]},{"id":"f6a1ee0b.4ed97","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":1700,"wires":[["ec1dd823.f12d18"]]},{"id":"842be559.36f148","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":1440,"y":1560,"wires":[]},{"id":"5703b04b.bc014","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":1450,"y":1660,"wires":[]},{"id":"a28822e3.9db4c","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":1700,"wires":[["f6a1ee0b.4ed97"]]},{"id":"5f7b2156.8217","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciabirigui","func":"global.set(\"potenciabirigui\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":1600,"wires":[[]]},{"id":"ec1dd823.f12d18","type":"function","z":"8a6aa23e.739d6","name":"set global_producaobirigui","func":"global.set(\"producaobirigui\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":1700,"wires":[[]]},{"id":"b6e8880b.656958","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":1940,"wires":[["28ab5ee5.7c66f2"]]},{"id":"5a233e02.5263b","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":660,"y":1860,"wires":[["97f2dfed.b13bc","1e28bef.6397741","6ca80513.8564ec"]]},{"id":"ceb6d245.2b6da","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[5];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":1860,"wires":[["5a233e02.5263b"]]},{"id":"97f2dfed.b13bc","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":1940,"wires":[["b6e8880b.656958"]]},{"id":"a0e2a110.1218c","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Matão","info":"","x":270,"y":1860,"wires":[]},{"id":"a9464b3d.0316a8","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":260,"y":1940,"wires":[]},{"id":"5f9606ad.063ab8","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":2020,"wires":[["20fc007c.ec608"]]},{"id":"1e28bef.6397741","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":2020,"wires":[["5f9606ad.063ab8"]]},{"id":"6aa7386a.3c8ce8","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":260,"y":2020,"wires":[]},{"id":"8f7649c8.d82998","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":2100,"wires":[["81365313.40dd"]]},{"id":"6ca80513.8564ec","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":2100,"wires":[["8f7649c8.d82998"]]},{"id":"3651ffab.e933","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":260,"y":2100,"wires":[]},{"id":"28ab5ee5.7c66f2","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":910,"y":1940,"wires":[["c3df44c4.66af88"],["7b8007f0.c168b8"]]},{"id":"20fc007c.ec608","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":916,"y":2018,"wires":[["7441f46d.dd43fc"],["7f4e56ac.07c738"]]},{"id":"81365313.40dd","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal ;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":910,"y":2100,"wires":[["e723cea1.9327e"],["c261af8d.9d97a"]]},{"id":"c3df44c4.66af88","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":1900,"wires":[["d293fc84.108b8"]]},{"id":"7441f46d.dd43fc","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2000,"wires":[["d293fc84.108b8"]]},{"id":"e723cea1.9327e","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2100,"wires":[["d293fc84.108b8"]]},{"id":"d293fc84.108b8","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1370,"y":1960,"wires":[["510dceca.2abe3"]]},{"id":"510dceca.2abe3","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1960,"wires":[["b0c910ea.b7f49"]]},{"id":"7b8007f0.c168b8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":1940,"wires":[["85330470.b414d8"]]},{"id":"7f4e56ac.07c738","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2040,"wires":[["85330470.b414d8"]]},{"id":"c261af8d.9d97a","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2140,"wires":[["85330470.b414d8"]]},{"id":"85330470.b414d8","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1370,"y":2060,"wires":[["b2bcf872.0accb8"]]},{"id":"38f4ab00.135066","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":2060,"wires":[["edc278b7.3d1988"]]},{"id":"c8ac3ceb.0eecd","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":1400,"y":1920,"wires":[]},{"id":"42ce4565.ea888c","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":1410,"y":2020,"wires":[]},{"id":"b2bcf872.0accb8","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":2060,"wires":[["38f4ab00.135066"]]},{"id":"4ebb5ea.2df61a","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciamatao","func":"global.set(\"potenciamatao\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":1960,"wires":[[]]},{"id":"edc278b7.3d1988","type":"function","z":"8a6aa23e.739d6","name":"set global_producaomatao","func":"global.set(\"producaomatao\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":2060,"wires":[[]]},{"id":"dab79467.61a388","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":380,"wires":[["dd1f6eb6.94419"]]},{"id":"9ef1d153.695a4","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2740,"y":300,"wires":[["1338233f.e8259d","a8f4bf38.890c2","9bb4ece1.2359"]]},{"id":"12b41aae.d24715","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[7];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":300,"wires":[["9ef1d153.695a4"]]},{"id":"1338233f.e8259d","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":380,"wires":[["dab79467.61a388"]]},{"id":"1eb47a3f.51d256","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Epitacio","info":"","x":2330,"y":300,"wires":[]},{"id":"ab2b8d4d.a4798","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2360,"y":380,"wires":[]},{"id":"9fc62855.134558","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":460,"wires":[["ac71b6da.4f21f8"]]},{"id":"a8f4bf38.890c2","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":460,"wires":[["9fc62855.134558"]]},{"id":"8d3da974.910da8","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2340,"y":460,"wires":[]},{"id":"66d6b686.d88d58","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":540,"wires":[["b785538e.1fe1a"]]},{"id":"9bb4ece1.2359","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":540,"wires":[["66d6b686.d88d58"]]},{"id":"1d9371c2.c516ee","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2340,"y":540,"wires":[]},{"id":"dd1f6eb6.94419","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2990,"y":380,"wires":[["455998be.1586d8"],["5dcaeb35.a8cb74"]]},{"id":"ac71b6da.4f21f8","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2996,"y":458,"wires":[["ef9d1f9.3bcd8e"],["ba8ca640.6a8eb8"]]},{"id":"b785538e.1fe1a","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2990,"y":540,"wires":[["8fe6087.b319bf8"],["ac49d296.738f"]]},{"id":"455998be.1586d8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":340,"wires":[["1d4e0d.35db91f4"]]},{"id":"ef9d1f9.3bcd8e","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":440,"wires":[["1d4e0d.35db91f4"]]},{"id":"8fe6087.b319bf8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":540,"wires":[["1d4e0d.35db91f4"]]},{"id":"1d4e0d.35db91f4","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3450,"y":400,"wires":[["c7548d9f.a7fa3"]]},{"id":"c7548d9f.a7fa3","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3620,"y":400,"wires":[["790850ab.cb9c7"]]},{"id":"5dcaeb35.a8cb74","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":380,"wires":[["ecd5c3f4.34a31"]]},{"id":"ba8ca640.6a8eb8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":480,"wires":[["ecd5c3f4.34a31"]]},{"id":"ac49d296.738f","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":580,"wires":[["ecd5c3f4.34a31"]]},{"id":"ecd5c3f4.34a31","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3450,"y":500,"wires":[["c5e2618.078fba"]]},{"id":"14a7dca9.633393","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3810,"y":500,"wires":[["5addc93a.4138d8"]]},{"id":"61679132.ca7d1","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":3480,"y":360,"wires":[]},{"id":"66b04227.79ba3c","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":3490,"y":460,"wires":[]},{"id":"c5e2618.078fba","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3620,"y":500,"wires":[["14a7dca9.633393"]]},{"id":"ca4d8741.7d5e78","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciaepitacio","func":"global.set(\"potenciaepitacio\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4000,"y":400,"wires":[[]]},{"id":"5addc93a.4138d8","type":"function","z":"8a6aa23e.739d6","name":"set global_producaoepitacio","func":"global.set(\"producaoepitacio\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4020,"y":500,"wires":[[]]},{"id":"75ddebcb.25fde4","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":840,"wires":[["9b1700f6.00455"]]},{"id":"b5fbb536.4104f8","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2840,"y":760,"wires":[["12de4d5e.758993","b1f9de30.2fb43","64f5ab65.e86754"]]},{"id":"9e19594.85750a8","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[10];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":760,"wires":[["b5fbb536.4104f8"]]},{"id":"12de4d5e.758993","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":840,"wires":[["75ddebcb.25fde4"]]},{"id":"9c11d10e.bff6e","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da PlantaSertaozinho","info":"","x":2440,"y":760,"wires":[]},{"id":"a7de1252.7bb47","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2460,"y":840,"wires":[]},{"id":"9638b55c.589ed8","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":920,"wires":[["9fa94303.82ca3"]]},{"id":"b1f9de30.2fb43","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":920,"wires":[["9638b55c.589ed8"]]},{"id":"8ea23618.338418","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2440,"y":920,"wires":[]},{"id":"58f158cf.fc6d98","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":1000,"wires":[["f5871de2.7d31b"]]},{"id":"64f5ab65.e86754","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":1000,"wires":[["58f158cf.fc6d98"]]},{"id":"852f7572.d20208","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2440,"y":1000,"wires":[]},{"id":"9b1700f6.00455","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3090,"y":840,"wires":[["d81ddf64.8f4b7"],["a2b6bc0f.814dd"]]},{"id":"9fa94303.82ca3","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3096,"y":918,"wires":[["2bc2980d.84d648"],["d877ea66.016b48"]]},{"id":"f5871de2.7d31b","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3090,"y":1000,"wires":[["ed9ff63c.93f168"],["2304aab4.687e66"]]},{"id":"d81ddf64.8f4b7","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":800,"wires":[["ed093e56.bb5da"]]},{"id":"2bc2980d.84d648","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":900,"wires":[["ed093e56.bb5da"]]},{"id":"ed9ff63c.93f168","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":1000,"wires":[["ed093e56.bb5da"]]},{"id":"ed093e56.bb5da","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3550,"y":860,"wires":[["482dd292.2e073c"]]},{"id":"482dd292.2e073c","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":860,"wires":[["6c1619c9.e64228"]]},{"id":"a2b6bc0f.814dd","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":840,"wires":[["ac881e4.6cb07e"]]},{"id":"d877ea66.016b48","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":940,"wires":[["ac881e4.6cb07e"]]},{"id":"2304aab4.687e66","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":1040,"wires":[["ac881e4.6cb07e"]]},{"id":"ac881e4.6cb07e","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3550,"y":960,"wires":[["278a141b.fbdd8c"]]},{"id":"e221bf97.f8de8","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3910,"y":960,"wires":[["2c2751f7.48171e"]]},{"id":"4e0d4f4e.79fd9","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":3580,"y":820,"wires":[]},{"id":"6416fd91.109f94","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":3590,"y":920,"wires":[]},{"id":"278a141b.fbdd8c","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":960,"wires":[["e221bf97.f8de8"]]},{"id":"f0973166.275b2","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciasetaozinho","func":"global.set(\"potenciasetaozinho\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4130,"y":860,"wires":[[]]},{"id":"2c2751f7.48171e","type":"function","z":"8a6aa23e.739d6","name":"set global_producaosetaozinho","func":"global.set(\"producaosertaozinho\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4130,"y":960,"wires":[[]]},{"id":"c64cb236.332d3","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1280,"wires":[["150e2f16.bfdb91"]]},{"id":"b7d492bb.c6346","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2860,"y":1200,"wires":[["143f38ca.3d3787","cf90a722.d660a8","beaa8247.0debc"]]},{"id":"c743296d.ef1ed8","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[11];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1180,"wires":[["b7d492bb.c6346"]]},{"id":"143f38ca.3d3787","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1280,"wires":[["c64cb236.332d3"]]},{"id":"99399294.f29b8","type":"comment","z":"8a6aa23e.739d6","name":"Escolha da Planta Votuporanga","info":"","x":2470,"y":1200,"wires":[]},{"id":"3303f17c.d7370e","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2480,"y":1280,"wires":[]},{"id":"6dc18190.89ad6","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1360,"wires":[["2715c6d.618cc3a"]]},{"id":"cf90a722.d660a8","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1360,"wires":[["6dc18190.89ad6"]]},{"id":"2405010d.84e86e","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2460,"y":1360,"wires":[]},{"id":"b9c986a4.fee108","type":"http request","z":"8a6aa23e.739d6","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1440,"wires":[["9af7291b.75ac88"]]},{"id":"beaa8247.0debc","type":"function","z":"8a6aa23e.739d6","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1440,"wires":[["b9c986a4.fee108"]]},{"id":"214e964d.39d3ca","type":"comment","z":"8a6aa23e.739d6","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2460,"y":1440,"wires":[]},{"id":"150e2f16.bfdb91","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3110,"y":1280,"wires":[["bca13648.917d78"],["87693c6e.44d4b"]]},{"id":"2715c6d.618cc3a","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3116,"y":1358,"wires":[["c4fc21c5.8f5f"],["17c5cec7.89df61"]]},{"id":"9af7291b.75ac88","type":"function","z":"8a6aa23e.739d6","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3110,"y":1440,"wires":[["9f1ce9ce.e467c8"],["2a4af176.a24c1e"]]},{"id":"bca13648.917d78","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1240,"wires":[["42736033.e4987"]]},{"id":"c4fc21c5.8f5f","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1340,"wires":[["42736033.e4987"]]},{"id":"9f1ce9ce.e467c8","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1440,"wires":[["42736033.e4987"]]},{"id":"42736033.e4987","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3570,"y":1300,"wires":[["f3fc1a5d.33fde8"]]},{"id":"f3fc1a5d.33fde8","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3740,"y":1300,"wires":[["40bc0d50.0262e4"]]},{"id":"87693c6e.44d4b","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1280,"wires":[["d00bf9db.39a548"]]},{"id":"17c5cec7.89df61","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1380,"wires":[["d00bf9db.39a548"]]},{"id":"2a4af176.a24c1e","type":"change","z":"8a6aa23e.739d6","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1480,"wires":[["d00bf9db.39a548"]]},{"id":"d00bf9db.39a548","type":"join","z":"8a6aa23e.739d6","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3570,"y":1400,"wires":[["7804da8d.451914"]]},{"id":"615a3736.d52ad8","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3930,"y":1400,"wires":[["fcf809b.2f429f8"]]},{"id":"4c27ddfb.a06f64","type":"comment","z":"8a6aa23e.739d6","name":"Soma potencias ","info":"","x":3600,"y":1260,"wires":[]},{"id":"727d96be.8e5818","type":"comment","z":"8a6aa23e.739d6","name":"Soma Producao Dia","info":"","x":3610,"y":1360,"wires":[]},{"id":"7804da8d.451914","type":"change","z":"8a6aa23e.739d6","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3740,"y":1400,"wires":[["615a3736.d52ad8"]]},{"id":"3ad4f262.20a1ee","type":"function","z":"8a6aa23e.739d6","name":"set global_potenciavotuporanga","func":"global.set(\"potenciavotuporanga\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4110,"y":1300,"wires":[[]]},{"id":"fcf809b.2f429f8","type":"function","z":"8a6aa23e.739d6","name":"set global_producaovotuporanga","func":"global.set(\"producaovotuporanga\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4160,"y":1400,"wires":[[]]},{"id":"924b774f.0df2f8","type":"debug","z":"8a6aa23e.739d6","name":"mensagens","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1250,"y":240,"wires":[]},{"id":"2f1e8d66.054a12","type":"debug","z":"8a6aa23e.739d6","name":"saidapay","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1190,"y":180,"wires":[]},{"id":"c8037cea.e5ad4","type":"inject","z":"8a6aa23e.739d6","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/3 6-18 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":60,"wires":[["b9068e03.70f07"]]},{"id":"40bc0d50.0262e4","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3890,"y":1300,"wires":[["3ad4f262.20a1ee"]]},{"id":"6c1619c9.e64228","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3910,"y":860,"wires":[["f0973166.275b2"]]},{"id":"790850ab.cb9c7","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3790,"y":400,"wires":[["ca4d8741.7d5e78"]]},{"id":"a89e8b7b.58f288","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":380,"wires":[["feeefb9f.4642c8"]]},{"id":"ac4834fc.10c758","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":820,"wires":[["67c859ad.5583d8"]]},{"id":"14624422.55917c","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":1200,"wires":[["7475cfe5.ae074"]]},{"id":"d19f68d3.98e8c8","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1790,"y":1600,"wires":[["5f7b2156.8217"]]},{"id":"b0c910ea.b7f49","type":"function","z":"8a6aa23e.739d6","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":1960,"wires":[["4ebb5ea.2df61a"]]},{"id":"5d305bdf.d0faf4","type":"debug","z":"8a6aa23e.739d6","name":"analise1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":810,"y":120,"wires":[]},{"id":"f5403b45.6a9018","type":"comment","z":"8a6aa23e.739d6","name":"4 - Catanduva","info":"","x":340,"y":240,"wires":[]},{"id":"6fb3a818.717998","type":"http request","z":"d3df83cf.c4d32","name":"login","method":"use","ret":"obj","url":"","tls":"","x":510,"y":100,"wires":[["655f81f8.f7317","17afc118.870f6f"]]},{"id":"88f83269.9f97","type":"http request","z":"d3df83cf.c4d32","name":"get Plant list","method":"use","ret":"obj","url":"","tls":"","x":490,"y":160,"wires":[["400c45fe.a22a4c","ab74f3fc.28ae1","d8b6cee4.23a28","dd78b485.dc4748","9ed1df58.4388b","9c8d81d1.f3ed5","3766a9ec.2986e6","7c3db845.533018","181e3084.e5c0e7"]]},{"id":"655f81f8.f7317","type":"function","z":"d3df83cf.c4d32","name":"","func":"msg.url='http://myevolvecloud.com/cpro/epc/plantview/view/doPlantList.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":160,"wires":[["88f83269.9f97"]]},{"id":"ee8265c5.553308","type":"function","z":"d3df83cf.c4d32","name":"Login Details","func":"msg.url='http://myevolvecloud.com/cpro/login/validateLogin.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['userName']='ifsp.solar@gmail.com';\nmsg.payload['password']='123456';\nmsg.payload['lan'] = '2';\nmsg.payload['domain']='myevolvecloud.com';\nmsg.payload['userType']='C';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":362,"y":62,"wires":[["6fb3a818.717998"]]},{"id":"4f37458a.86917c","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Catanduva","info":"data[3]=Catanduva","x":140,"y":300,"wires":[]},{"id":"69bf0790.ab2f18","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":180,"y":380,"wires":[]},{"id":"b6a47320.a1a05","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":180,"y":460,"wires":[]},{"id":"d139c41c.748448","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":180,"y":540,"wires":[]},{"id":"22d5f08b.6e12a","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":400,"wires":[["e7a38228.b7fb"]]},{"id":"e7a38228.b7fb","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":400,"wires":[["78b28e1f.8c6fd"]]},{"id":"6c14d353.59720c","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":500,"wires":[["199a142.c2221ec"]]},{"id":"a0266c57.82cb6","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":500,"wires":[["7576f476.f7e18c","ea26527b.d15b2"]]},{"id":"cca1e201.59d48","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":1440,"y":360,"wires":[]},{"id":"6dd9ce03.4f127","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":1450,"y":460,"wires":[]},{"id":"199a142.c2221ec","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":500,"wires":[["a0266c57.82cb6"]]},{"id":"4fd9de47.e3346","type":"function","z":"d3df83cf.c4d32","name":"set global_potencia catanduva","func":"global.set(\"potenciacatanduva\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":380,"wires":[[]]},{"id":"7576f476.f7e18c","type":"function","z":"d3df83cf.c4d32","name":"set global_producao catanduva","func":"global.set(\"producaocatanduva\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":460,"wires":[[]]},{"id":"af9c75.00a67388","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":800,"wires":[["c930cffd.e3586"]]},{"id":"be529d97.594c5","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":680,"y":720,"wires":[["a4eb6eb5.c6a85","b89a7ec3.48154","ff2a9a5e.3159d8","90cabb25.0bb178"]]},{"id":"400c45fe.a22a4c","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[0];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":720,"wires":[["be529d97.594c5"]]},{"id":"a4eb6eb5.c6a85","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":800,"wires":[["af9c75.00a67388"]]},{"id":"92c022ec.bc37d","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta 0 - Araraquara","info":"data[3]=Catanduva","x":150,"y":720,"wires":[]},{"id":"a4643b24.fa7458","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":180,"y":800,"wires":[]},{"id":"7d7e7e98.3779c","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":880,"wires":[["71a034e1.48421c"]]},{"id":"b89a7ec3.48154","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":880,"wires":[["7d7e7e98.3779c"]]},{"id":"9afaa4be.a291b8","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":160,"y":880,"wires":[]},{"id":"4ac814d2.06f75c","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":960,"wires":[["ae3c862d.aa0638"]]},{"id":"ff2a9a5e.3159d8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":960,"wires":[["4ac814d2.06f75c"]]},{"id":"c8cc0afa.94f168","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":160,"y":960,"wires":[]},{"id":"c930cffd.e3586","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":"var mensagens = { payload : msg.inverterData};\n\nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a , mensagens ];\n\n\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":930,"y":800,"wires":[["ec397a3.afd1788"],["16e3a426.7b5c4c"],[]]},{"id":"71a034e1.48421c","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":936,"y":878,"wires":[["aa92a415.313918"],["999d9f91.ef2c9"]]},{"id":"ae3c862d.aa0638","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":960,"wires":[["7c83748.2ae5a8c"],["b842be6e.c141c"]]},{"id":"ec397a3.afd1788","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":760,"wires":[["4390cfde.50837"]]},{"id":"aa92a415.313918","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":860,"wires":[["4390cfde.50837"]]},{"id":"7c83748.2ae5a8c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":960,"wires":[["4390cfde.50837"]]},{"id":"4390cfde.50837","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":820,"wires":[["47ba7608.7d9ec8"]]},{"id":"47ba7608.7d9ec8","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":820,"wires":[["b2a787b8.591078"]]},{"id":"16e3a426.7b5c4c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":800,"wires":[["3bfbce35.0e0242"]]},{"id":"999d9f91.ef2c9","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":900,"wires":[["3bfbce35.0e0242"]]},{"id":"b842be6e.c141c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1000,"wires":[["3bfbce35.0e0242"]]},{"id":"3bfbce35.0e0242","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":920,"wires":[["d3104223.c09a"]]},{"id":"a9a5713.3c32d9","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":920,"wires":[["c5f3e6c6.e1f608"]]},{"id":"cf4cf7fc.8b9fd8","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":1420,"y":780,"wires":[]},{"id":"d950191.79f23e8","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":1430,"y":880,"wires":[]},{"id":"d3104223.c09a","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":920,"wires":[["a9a5713.3c32d9"]]},{"id":"75b00356.f4af1c","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciaararaquara","func":"global.set(\"potenciaararaquara\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":820,"wires":[[]]},{"id":"c5f3e6c6.e1f608","type":"function","z":"d3df83cf.c4d32","name":"set global_producaoaararaquara","func":"global.set(\"producaoaararaquara\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1970,"y":920,"wires":[[]]},{"id":"a7647a2e.a82ad8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1180,"wires":[["dac4e1a1.b2283"]]},{"id":"f1fab326.e842a","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":680,"y":1100,"wires":[["37c750db.5ab38","ad881b1a.0804f8","d51caa83.8af9b8","728c28e0.f7d138"]]},{"id":"ab74f3fc.28ae1","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[1];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1100,"wires":[["f1fab326.e842a"]]},{"id":"37c750db.5ab38","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1180,"wires":[["a7647a2e.a82ad8"]]},{"id":"f68076d4.70b6c8","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Barretos","info":"","x":270,"y":1100,"wires":[]},{"id":"9f11cabd.0e0688","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":300,"y":1180,"wires":[]},{"id":"be4307af.e6db48","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1260,"wires":[["af6b81f.4dd138"]]},{"id":"ad881b1a.0804f8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1260,"wires":[["be4307af.e6db48"]]},{"id":"d33f0182.14eaf","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":280,"y":1260,"wires":[]},{"id":"4793ea73.020b14","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":690,"y":1340,"wires":[["b5f1dacb.d1e4f8"]]},{"id":"d51caa83.8af9b8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1340,"wires":[["4793ea73.020b14"]]},{"id":"df1e389b.4343f8","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":280,"y":1340,"wires":[]},{"id":"dac4e1a1.b2283","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":1180,"wires":[["81f4d07e.65e53"],["4287199.ab5cee8"]]},{"id":"af6b81f.4dd138","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":936,"y":1258,"wires":[["dfa9e9d7.7a4898"],["4dcef2d0.647f9c"]]},{"id":"b5f1dacb.d1e4f8","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":930,"y":1340,"wires":[["c3ad133c.1c5e"],["a69d31df.508fa"]]},{"id":"81f4d07e.65e53","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1140,"wires":[["e04d1df8.b3852"]]},{"id":"dfa9e9d7.7a4898","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1240,"wires":[["e04d1df8.b3852"]]},{"id":"c3ad133c.1c5e","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1340,"wires":[["e04d1df8.b3852"]]},{"id":"e04d1df8.b3852","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":1200,"wires":[["2e3fb118.8f55ae"]]},{"id":"2e3fb118.8f55ae","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":1200,"wires":[["49a4b108.1a165"]]},{"id":"4287199.ab5cee8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1180,"wires":[["8c985c8.2b9d1a"]]},{"id":"4dcef2d0.647f9c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1280,"wires":[["8c985c8.2b9d1a"]]},{"id":"a69d31df.508fa","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1380,"wires":[["8c985c8.2b9d1a"]]},{"id":"8c985c8.2b9d1a","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1390,"y":1300,"wires":[["c82bf57.ed37a08"]]},{"id":"c5127ad6.c82148","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":1300,"wires":[["1a3c10cd.c5bdbf"]]},{"id":"788e0f6b.329f3","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":1420,"y":1160,"wires":[]},{"id":"df703ec5.f8bb1","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":1430,"y":1260,"wires":[]},{"id":"c82bf57.ed37a08","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":1300,"wires":[["c5127ad6.c82148"]]},{"id":"70d16d46.d638e4","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciabarretos","func":"global.set(\"potenciabarretos\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":1200,"wires":[[]]},{"id":"1a3c10cd.c5bdbf","type":"function","z":"d3df83cf.c4d32","name":"set global_producaobarretos","func":"global.set(\"producaobarretos\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":1300,"wires":[[]]},{"id":"ae408d89.ad4a5","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1580,"wires":[["1d71ca14.71e6c6"]]},{"id":"7083b67.e2f0248","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":700,"y":1500,"wires":[["c6aec832.59f5e8","ac82961e.4a4eb8","efba4dff.b351e"]]},{"id":"d8b6cee4.23a28","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[2];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1500,"wires":[["7083b67.e2f0248"]]},{"id":"c6aec832.59f5e8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1580,"wires":[["ae408d89.ad4a5"]]},{"id":"9ea09501.d29938","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Birigui","info":"","x":290,"y":1500,"wires":[]},{"id":"a07469f1.53bd58","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":320,"y":1580,"wires":[]},{"id":"20dc67a.b03dc98","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1660,"wires":[["2aca4f9a.44e49"]]},{"id":"ac82961e.4a4eb8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1660,"wires":[["20dc67a.b03dc98"]]},{"id":"e69f5a90.3a1bd8","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":300,"y":1660,"wires":[]},{"id":"f6f49979.dbece8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":1740,"wires":[["ce1cfbf3.80ae58"]]},{"id":"efba4dff.b351e","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1740,"wires":[["f6f49979.dbece8"]]},{"id":"fb0c21c4.8ae79","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":300,"y":1740,"wires":[]},{"id":"1d71ca14.71e6c6","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":1580,"wires":[["76bba725.640678"],["ea47940c.218c98"]]},{"id":"2aca4f9a.44e49","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":956,"y":1658,"wires":[["ed0456ab.59a808"],["b67c9b6b.0ca628"]]},{"id":"ce1cfbf3.80ae58","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal ;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":1740,"wires":[["36925b5b.253c04"],["254a1cf3.bd3124"]]},{"id":"76bba725.640678","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1540,"wires":[["51897be.18d6784"]]},{"id":"ed0456ab.59a808","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1640,"wires":[["51897be.18d6784"]]},{"id":"36925b5b.253c04","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1740,"wires":[["51897be.18d6784"]]},{"id":"51897be.18d6784","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":1600,"wires":[["e95a9fb5.b73a8"]]},{"id":"e95a9fb5.b73a8","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":1600,"wires":[["2830d7a7.3f0838"]]},{"id":"ea47940c.218c98","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1580,"wires":[["7a2523d2.adb68c"]]},{"id":"b67c9b6b.0ca628","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1680,"wires":[["7a2523d2.adb68c"]]},{"id":"254a1cf3.bd3124","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":1780,"wires":[["7a2523d2.adb68c"]]},{"id":"7a2523d2.adb68c","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1410,"y":1700,"wires":[["d0b36642.8ae878"]]},{"id":"203186ff.9cfb5a","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":1700,"wires":[["a0d8bdb6.214e5"]]},{"id":"2f6348eb.c01e38","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":1440,"y":1560,"wires":[]},{"id":"defd9ba3.7fa688","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":1450,"y":1660,"wires":[]},{"id":"d0b36642.8ae878","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":1700,"wires":[["203186ff.9cfb5a"]]},{"id":"aa8af549.dd9478","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciabirigui","func":"global.set(\"potenciabirigui\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":1600,"wires":[[]]},{"id":"a0d8bdb6.214e5","type":"function","z":"d3df83cf.c4d32","name":"set global_producaobirigui","func":"global.set(\"producaobirigui\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":1700,"wires":[[]]},{"id":"9d22792f.434728","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":1940,"wires":[["4f052b91.d43384"]]},{"id":"286627f.f6ea0d8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":660,"y":1860,"wires":[["7a2e7b4c.275674","b2e3733f.7a4c4","321813a.aceb4ec","7da2b975.687da8"]]},{"id":"dd78b485.dc4748","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[7];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":1860,"wires":[["286627f.f6ea0d8"]]},{"id":"7a2e7b4c.275674","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":1940,"wires":[["9d22792f.434728"]]},{"id":"6a5aef9a.ae8cd","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Matão","info":"","x":250,"y":1860,"wires":[]},{"id":"71c28cc3.fa5dd4","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":280,"y":1940,"wires":[]},{"id":"5cb77e8f.01688","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":2020,"wires":[["b19994f4.a1c5c8"]]},{"id":"b2e3733f.7a4c4","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":2020,"wires":[["5cb77e8f.01688"]]},{"id":"94da3ef5.87ae4","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":260,"y":2020,"wires":[]},{"id":"b23f65b.2a2d598","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":670,"y":2100,"wires":[["aa0640a9.8afb1"]]},{"id":"321813a.aceb4ec","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":2100,"wires":[["b23f65b.2a2d598"]]},{"id":"84b57519.e95778","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":260,"y":2100,"wires":[]},{"id":"4f052b91.d43384","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":910,"y":1940,"wires":[["40ab90b7.27e68"],["dd7c6f6f.6e94c"]]},{"id":"b19994f4.a1c5c8","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":916,"y":2018,"wires":[["a9b2c886.9528e8"],["f00dbdad.c097"]]},{"id":"aa0640a9.8afb1","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal ;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":910,"y":2100,"wires":[["9746f4fd.2869d8"],["697c3888.b27d58"]]},{"id":"40ab90b7.27e68","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":1900,"wires":[["9173c15f.7e513"]]},{"id":"a9b2c886.9528e8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2000,"wires":[["9173c15f.7e513"]]},{"id":"9746f4fd.2869d8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2100,"wires":[["9173c15f.7e513"]]},{"id":"9173c15f.7e513","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1370,"y":1960,"wires":[["fba993fb.3da13"]]},{"id":"fba993fb.3da13","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1960,"wires":[["894b95d2.363bc8"]]},{"id":"dd7c6f6f.6e94c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":1940,"wires":[["1a4af911.4e3757"]]},{"id":"f00dbdad.c097","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2040,"wires":[["1a4af911.4e3757"]]},{"id":"697c3888.b27d58","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":2140,"wires":[["1a4af911.4e3757"]]},{"id":"1a4af911.4e3757","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1370,"y":2060,"wires":[["2a2922a9.2206ce"]]},{"id":"b9e5f61c.5f7d48","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":2060,"wires":[["e00bad49.ae834"]]},{"id":"4acaadd3.811b94","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":1400,"y":1920,"wires":[]},{"id":"34c5a790.a045d8","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":1410,"y":2020,"wires":[]},{"id":"2a2922a9.2206ce","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":2060,"wires":[["b9e5f61c.5f7d48"]]},{"id":"6ee5eae0.a3db84","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciamatao","func":"global.set(\"potenciamatao\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":1960,"wires":[[]]},{"id":"e00bad49.ae834","type":"function","z":"d3df83cf.c4d32","name":"set global_producaomatao","func":"global.set(\"producaomatao\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":2060,"wires":[[]]},{"id":"194f2b30.290865","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":380,"wires":[["28026f8f.46883"]]},{"id":"2c6fc3ab.2a030c","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2740,"y":300,"wires":[["3192cb07.278a34","456b2163.68c29","d46e9e94.5ca6","a97057b3.c5f0a8"]]},{"id":"9ed1df58.4388b","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[3];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":300,"wires":[["2c6fc3ab.2a030c"]]},{"id":"3192cb07.278a34","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":380,"wires":[["194f2b30.290865"]]},{"id":"8baf064a.4cdc58","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Epitacio","info":"","x":2330,"y":300,"wires":[]},{"id":"8526765.d79bb88","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2360,"y":380,"wires":[]},{"id":"fc6e2aff.29a628","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":460,"wires":[["1f0d1019.8a5ec"]]},{"id":"456b2163.68c29","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":460,"wires":[["fc6e2aff.29a628"]]},{"id":"9c44ec4a.e7319","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2340,"y":460,"wires":[]},{"id":"232b7b7.37f9984","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2750,"y":540,"wires":[["b40fb306.4d9e7"]]},{"id":"d46e9e94.5ca6","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2560,"y":540,"wires":[["232b7b7.37f9984"]]},{"id":"3b5bc3da.d3a7fc","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2340,"y":540,"wires":[]},{"id":"28026f8f.46883","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2990,"y":380,"wires":[["e5520e9c.bc9e4"],["d5938cf8.d73f8"]]},{"id":"1f0d1019.8a5ec","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2996,"y":458,"wires":[["6a0b8b0.f3ba874"],["1efe206.d95cee"]]},{"id":"b40fb306.4d9e7","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":2990,"y":540,"wires":[["3893b7b7.8a4d38"],["66487a5.2aa2384"]]},{"id":"e5520e9c.bc9e4","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":340,"wires":[["7f547883.4f7c98"]]},{"id":"6a0b8b0.f3ba874","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":440,"wires":[["7f547883.4f7c98"]]},{"id":"3893b7b7.8a4d38","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":540,"wires":[["7f547883.4f7c98"]]},{"id":"7f547883.4f7c98","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3450,"y":400,"wires":[["d691c922.d5ba08"]]},{"id":"d691c922.d5ba08","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3620,"y":400,"wires":[["1610e2ee.66d66d"]]},{"id":"d5938cf8.d73f8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":380,"wires":[["71724aee.80e6c4"]]},{"id":"1efe206.d95cee","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":480,"wires":[["71724aee.80e6c4"]]},{"id":"66487a5.2aa2384","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3240,"y":580,"wires":[["71724aee.80e6c4"]]},{"id":"71724aee.80e6c4","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3450,"y":500,"wires":[["2c39a736.45bbc8"]]},{"id":"9da967d5.e178a8","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3810,"y":500,"wires":[["e7c698bf.449b18"]]},{"id":"a02e569a.49ed78","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":3480,"y":360,"wires":[]},{"id":"16af5057.3a509","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":3490,"y":460,"wires":[]},{"id":"2c39a736.45bbc8","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3620,"y":500,"wires":[["9da967d5.e178a8"]]},{"id":"9469535e.6b09a","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciaepitacio","func":"global.set(\"potenciaepitacio\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4000,"y":400,"wires":[[]]},{"id":"e7c698bf.449b18","type":"function","z":"d3df83cf.c4d32","name":"set global_producaoepitacio","func":"global.set(\"producaoepitacio\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4020,"y":500,"wires":[[]]},{"id":"b7626b89.e3d098","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":840,"wires":[["c41d9b39.4b2de8"]]},{"id":"c327ed27.4344e","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2840,"y":760,"wires":[["d3e8f918.b18b38","355ba75.aa2f758","552ecafa.d92d14","de194835.44ff5"]]},{"id":"9c8d81d1.f3ed5","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[13];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":760,"wires":[["c327ed27.4344e"]]},{"id":"d3e8f918.b18b38","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":840,"wires":[["b7626b89.e3d098"]]},{"id":"29da14ce.54bcec","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da PlantaSertaozinho","info":"","x":2440,"y":760,"wires":[]},{"id":"c2309270.41d4d","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2460,"y":840,"wires":[]},{"id":"fb33f621.b6d6b8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":920,"wires":[["d75eb83e.17e098"]]},{"id":"355ba75.aa2f758","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":920,"wires":[["fb33f621.b6d6b8"]]},{"id":"57b4d960.4e1d98","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2440,"y":920,"wires":[]},{"id":"7f8d2a57.593904","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2850,"y":1000,"wires":[["fa8d23d3.a1856"]]},{"id":"552ecafa.d92d14","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":1000,"wires":[["7f8d2a57.593904"]]},{"id":"db4d84f.20a6678","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2440,"y":1000,"wires":[]},{"id":"c41d9b39.4b2de8","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3090,"y":840,"wires":[["d88c31ea.e6ed7"],["9b91fc7.3bbe"]]},{"id":"d75eb83e.17e098","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3096,"y":918,"wires":[["831db342.b642e"],["9d0aef33.485d8"]]},{"id":"fa8d23d3.a1856","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3090,"y":1000,"wires":[["922b4593.e3aa58"],["b2100a4d.955178"]]},{"id":"d88c31ea.e6ed7","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":800,"wires":[["e75a97ec.f17868"]]},{"id":"831db342.b642e","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":900,"wires":[["e75a97ec.f17868"]]},{"id":"922b4593.e3aa58","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":1000,"wires":[["e75a97ec.f17868"]]},{"id":"e75a97ec.f17868","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3550,"y":860,"wires":[["dc146f2.539ac9"]]},{"id":"dc146f2.539ac9","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":860,"wires":[["6120c660.5b4958"]]},{"id":"9b91fc7.3bbe","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":840,"wires":[["517080fd.8373c"]]},{"id":"9d0aef33.485d8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":940,"wires":[["517080fd.8373c"]]},{"id":"b2100a4d.955178","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3340,"y":1040,"wires":[["517080fd.8373c"]]},{"id":"517080fd.8373c","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3550,"y":960,"wires":[["562430c.c32dbd"]]},{"id":"a2c8ec83.ad663","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3910,"y":960,"wires":[["5879af4c.f48a3"]]},{"id":"43a14f60.ef148","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":3580,"y":820,"wires":[]},{"id":"e640660e.6d2a28","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":3590,"y":920,"wires":[]},{"id":"562430c.c32dbd","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":960,"wires":[["a2c8ec83.ad663"]]},{"id":"fb3d12a6.9dcc3","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciasetaozinho","func":"global.set(\"potenciasetaozinho\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4130,"y":860,"wires":[[]]},{"id":"5879af4c.f48a3","type":"function","z":"d3df83cf.c4d32","name":"set global_producaosetaozinho","func":"global.set(\"producaosertaozinho\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4130,"y":960,"wires":[[]]},{"id":"73b8b49.f79294c","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1280,"wires":[["93ac8a42.6f3d28"]]},{"id":"c5ed3535.988fe8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":2860,"y":1200,"wires":[["4b701d74.ac81a4","c0ed309d.5e3e1","eec4c652.8d22d8"]]},{"id":"3766a9ec.2986e6","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[12];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1180,"wires":[["c5ed3535.988fe8"]]},{"id":"4b701d74.ac81a4","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1280,"wires":[["73b8b49.f79294c"]]},{"id":"defee745.f1dc98","type":"comment","z":"d3df83cf.c4d32","name":"Escolha da Planta Votuporanga","info":"","x":2470,"y":1200,"wires":[]},{"id":"ca3388bf.b03d68","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 1","info":"data[0] = Inversor 1","x":2480,"y":1280,"wires":[]},{"id":"44516aa1.f3cca4","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1360,"wires":[["680c6750.2bca18"]]},{"id":"c0ed309d.5e3e1","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1360,"wires":[["44516aa1.f3cca4"]]},{"id":"b0347069.609c","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 2","info":"data[1] = Inversor 2","x":2460,"y":1360,"wires":[]},{"id":"77cd260e.b0f048","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":2870,"y":1440,"wires":[["daec3242.be58d"]]},{"id":"eec4c652.8d22d8","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2680,"y":1440,"wires":[["77cd260e.b0f048"]]},{"id":"5c69618b.65317","type":"comment","z":"d3df83cf.c4d32","name":"Escolha do Inversor 3","info":"data[2] = Inversor 3","x":2460,"y":1440,"wires":[]},{"id":"93ac8a42.6f3d28","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal1 = msg.inverterData.powerTotal;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3110,"y":1280,"wires":[["27fa512b.0cc06e"],["ccb7f972.e3f9f8"]]},{"id":"680c6750.2bca18","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3116,"y":1358,"wires":[["a34852bd.19565"],["8c5a9cbf.4ff11"]]},{"id":"daec3242.be58d","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":3110,"y":1440,"wires":[["a82da059.9795d"],["ee390d5d.ba587"]]},{"id":"27fa512b.0cc06e","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1240,"wires":[["6a6cb2c2.a81ebc"]]},{"id":"a34852bd.19565","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1340,"wires":[["6a6cb2c2.a81ebc"]]},{"id":"a82da059.9795d","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1440,"wires":[["6a6cb2c2.a81ebc"]]},{"id":"6a6cb2c2.a81ebc","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3570,"y":1300,"wires":[["1f8329bc.653106"]]},{"id":"1f8329bc.653106","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3740,"y":1300,"wires":[["18e6756.320fb8b"]]},{"id":"ccb7f972.e3f9f8","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1280,"wires":[["6b055613.62e898"]]},{"id":"8c5a9cbf.4ff11","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1380,"wires":[["6b055613.62e898"]]},{"id":"ee390d5d.ba587","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3360,"y":1480,"wires":[["6b055613.62e898"]]},{"id":"6b055613.62e898","type":"join","z":"d3df83cf.c4d32","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":3570,"y":1400,"wires":[["a26ed9af.c71708"]]},{"id":"6b16bfdc.ea356","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3930,"y":1400,"wires":[["e4674eb8.8f72b"]]},{"id":"d03319a0.71add8","type":"comment","z":"d3df83cf.c4d32","name":"Soma potencias ","info":"","x":3600,"y":1260,"wires":[]},{"id":"a5e9383d.f39e88","type":"comment","z":"d3df83cf.c4d32","name":"Soma Producao Dia","info":"","x":3610,"y":1360,"wires":[]},{"id":"a26ed9af.c71708","type":"change","z":"d3df83cf.c4d32","name":"$sum(payload)","rules":[{"t":"set","p":"payload","pt":"msg","to":"$sum(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3740,"y":1400,"wires":[["6b16bfdc.ea356"]]},{"id":"1a30263c.55585a","type":"function","z":"d3df83cf.c4d32","name":"set global_potenciavotuporanga","func":"global.set(\"potenciavotuporanga\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4110,"y":1300,"wires":[[]]},{"id":"e4674eb8.8f72b","type":"function","z":"d3df83cf.c4d32","name":"set global_producaovotuporanga","func":"global.set(\"producaovotuporanga\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4160,"y":1400,"wires":[[]]},{"id":"4f70b362.ffd92c","type":"inject","z":"d3df83cf.c4d32","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"*/3 6-18 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":60,"wires":[["ee8265c5.553308"]]},{"id":"18e6756.320fb8b","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3890,"y":1300,"wires":[["1a30263c.55585a"]]},{"id":"6120c660.5b4958","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3910,"y":860,"wires":[["fb3d12a6.9dcc3"]]},{"id":"1610e2ee.66d66d","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3790,"y":400,"wires":[["9469535e.6b09a"]]},{"id":"78b28e1f.8c6fd","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":380,"wires":[["4fd9de47.e3346","ea26527b.d15b2"]]},{"id":"b2a787b8.591078","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":820,"wires":[["75b00356.f4af1c"]]},{"id":"49a4b108.1a165","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1730,"y":1200,"wires":[["70d16d46.d638e4"]]},{"id":"2830d7a7.3f0838","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1790,"y":1600,"wires":[["aa8af549.dd9478"]]},{"id":"894b95d2.363bc8","type":"function","z":"d3df83cf.c4d32","name":"inteiro","func":"//msg.payload = Number(msg.payload);//\n//return msg;\nvar originalNumber = msg.payload;\nvar formatedString = originalNumber.toFixed(1) // 5.7 (string)\nvar formatedNumber = parseFloat(formatedString)  // 5.7 (number)\nmsg.payload = formatedNumber;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1750,"y":1960,"wires":[["6ee5eae0.a3db84"]]},{"id":"152b4569.8b83bb","type":"comment","z":"d3df83cf.c4d32","name":"4 - Catanduva","info":"","x":220,"y":240,"wires":[]},{"id":"17afc118.870f6f","type":"debug","z":"d3df83cf.c4d32","name":"analise0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":760,"y":60,"wires":[]},{"id":"90cabb25.0bb178","type":"debug","z":"d3df83cf.c4d32","name":"analise2","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":900,"y":720,"wires":[]},{"id":"91aae62e.0e1428","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":380,"wires":[["9e6d30c7.6aea3"]]},{"id":"cff0c79d.514338","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter list","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":700,"y":300,"wires":[["5c8a35df.319dbc","8f2b3c34.dd65c","80a6ee6.7dbf61","3fdd1477.ca87cc"]]},{"id":"7c3db845.533018","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[7];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":300,"wires":[["cff0c79d.514338"]]},{"id":"5c8a35df.319dbc","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[0];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":380,"wires":[["91aae62e.0e1428"]]},{"id":"c9970bd2.7794f8","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":460,"wires":[["7cbbb1d6.3c8e1"]]},{"id":"8f2b3c34.dd65c","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[1];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":460,"wires":[["c9970bd2.7794f8"]]},{"id":"f5e38b66.c95c68","type":"http request","z":"d3df83cf.c4d32","name":"get Inverter details","method":"POST","ret":"obj","url":"","tls":"","x":710,"y":540,"wires":[["b8ca50b4.80775"]]},{"id":"80a6ee6.7dbf61","type":"function","z":"d3df83cf.c4d32","name":"","func":"\nmsg.inverterData = msg.payload.result.paginationAjax.data[2];\n\nmsg.url='http://myevolvecloud.com/cpro/device/inverter/goDetailAjax.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['deviceId']=msg.inverterData.deviceId;\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":540,"wires":[["f5e38b66.c95c68"]]},{"id":"9e6d30c7.6aea3","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":"var mensagens = { payload : msg.inverterData};\n\nvar pontenciatotal1 = msg.inverterData.powerTotal ;\nvar producao1 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal1 = pontenciatotal1 ; \n\n} else {\n   pontenciatotal1 = pontenciatotal1 * 1000;\n}\n\npontenciatotal1a = { payload : pontenciatotal1 };\nproducao1a = { payload : producao1 };\n\n\nreturn [ pontenciatotal1a, producao1a , mensagens ];\n\n\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":950,"y":380,"wires":[["8212908d.44156"],["61e7b1a1.c7f4c"],[]]},{"id":"7cbbb1d6.3c8e1","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal2 = msg.inverterData.powerTotal;\nvar producao2 = msg.inverterData.energyToday;\n\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal2 = pontenciatotal2 ; \n\n} else {\n   pontenciatotal2 = pontenciatotal2 * 1000;\n}\n\npontenciatotal2a = { payload : pontenciatotal2 };\nproducao2a = { payload : producao2 };\n\n\nreturn [ pontenciatotal2a, producao2a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":956,"y":458,"wires":[["9e04614a.1b741"],["3baf54eb.43999c"]]},{"id":"b8ca50b4.80775","type":"function","z":"d3df83cf.c4d32","name":"json_multiplasvariaveis","func":" \nvar pontenciatotal3 = msg.inverterData.powerTotal;\nvar producao3 = msg.inverterData.energyToday;\n\n// verifica unidade\nvar unidade = msg.inverterData.powerUnit;\nif (unidade ===\"W\") {\n   pontenciatotal3 = pontenciatotal3 ; \n\n} else {\n   pontenciatotal3 = pontenciatotal3 * 1000;\n}\n\npontenciatotal3a = { payload : pontenciatotal3 };\nproducao3a = { payload : producao3 };\n\n\nreturn [ pontenciatotal3a, producao3a ];\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":950,"y":540,"wires":[["2f776667.93bbaa"],["3ff770cc.3f79e"]]},{"id":"8212908d.44156","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":340,"wires":[["22d5f08b.6e12a"]]},{"id":"9e04614a.1b741","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":440,"wires":[["22d5f08b.6e12a"]]},{"id":"2f776667.93bbaa","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":540,"wires":[["22d5f08b.6e12a"]]},{"id":"61e7b1a1.c7f4c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":380,"wires":[["6c14d353.59720c"]]},{"id":"3baf54eb.43999c","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":480,"wires":[["6c14d353.59720c"]]},{"id":"3ff770cc.3f79e","type":"change","z":"d3df83cf.c4d32","name":"","rules":[{"t":"set","p":"parts","pt":"msg","to":"3","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":580,"wires":[["6c14d353.59720c"]]},{"id":"3fdd1477.ca87cc","type":"debug","z":"d3df83cf.c4d32","name":"6 - Catanduva","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":900,"y":240,"wires":[]},{"id":"ada3e55b.656008","type":"comment","z":"d3df83cf.c4d32","name":"lista das cidades por numero","info":"0- Araraquara\n1 - Barretos\n2 - Birigui\n3 - Catanduva\n4-  Campinas\n5 - Capivari\n7 - Catanduva\n - matao\n\n - Piracicaba\n8 - Pres. Epitacio\n9 - Sao Roque\n10 - Salto\n11 - Sertaozinho\n\n13 - Votuporanga\n","x":800,"y":120,"wires":[]},{"id":"ea26527b.d15b2","type":"debug","z":"d3df83cf.c4d32","name":"saida catanduva","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1960,"y":300,"wires":[]},{"id":"728c28e0.f7d138","type":"debug","z":"d3df83cf.c4d32","name":"saida 3","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":910,"y":1060,"wires":[]},{"id":"7da2b975.687da8","type":"debug","z":"d3df83cf.c4d32","name":"matao","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":900,"y":1840,"wires":[]},{"id":"a97057b3.c5f0a8","type":"debug","z":"d3df83cf.c4d32","name":"epitacio","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2990,"y":240,"wires":[]},{"id":"de194835.44ff5","type":"debug","z":"d3df83cf.c4d32","name":"13-Sertaozinho","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":3110,"y":720,"wires":[]},{"id":"181e3084.e5c0e7","type":"debug","z":"d3df83cf.c4d32","name":"get_litsta","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":850,"y":160,"wires":[]},{"id":"dbfe10d4.2a068","type":"http request","z":"150a0205.bcdd1e","name":"login","method":"use","ret":"obj","url":"","tls":"","x":430,"y":180,"wires":[["ac12d196.9abe88","76457245.1b6034"]]},{"id":"fc02a9bf.bf0358","type":"http request","z":"150a0205.bcdd1e","name":"get Plant list","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":410,"y":240,"wires":[["464e1bdd.aa1d2c","4d980b1a.6a9a84"]]},{"id":"ac12d196.9abe88","type":"function","z":"150a0205.bcdd1e","name":"","func":"msg.url='http://myevolvecloud.com/cpro/epc/plantview/view/doPlantList.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":240,"y":240,"wires":[["fc02a9bf.bf0358"]]},{"id":"8fc81aa8.9e1748","type":"function","z":"150a0205.bcdd1e","name":"Login Details","func":"msg.url='http://myevolvecloud.com/cpro/login/validateLogin.json';\nmsg.method =  'POST';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\nmsg.payload['userName']='ifsp.solar@gmail.com';\nmsg.payload['password']='123456';\nmsg.payload['lan'] = '2';\nmsg.payload['domain']='myevolvecloud.com';\nmsg.payload['userType']='C';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":282,"y":142,"wires":[["dbfe10d4.2a068"]]},{"id":"38e4c23e.b82c4e","type":"comment","z":"150a0205.bcdd1e","name":"4 - Catanduva","info":"","x":140,"y":320,"wires":[]},{"id":"76457245.1b6034","type":"debug","z":"150a0205.bcdd1e","name":"analise0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":680,"y":140,"wires":[]},{"id":"5a26d7a8.20c228","type":"http request","z":"150a0205.bcdd1e","name":"get Inverter list","method":"use","ret":"obj","url":"","tls":"","x":760,"y":240,"wires":[["9d66eb97.d8049"]]},{"id":"464e1bdd.aa1d2c","type":"function","z":"150a0205.bcdd1e","name":"","func":"\nmsg.plantData = msg.payload.result.pagination.data[6];\n\nmsg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=\"+msg.plantData.plantId+\"&sequenceNum=9&showAddFlg=1\";\n//msg.url=\"http://myevolvecloud.com/cpro/epc/plantDevice/inverterListAjax.json?orderBy=updateDate&orderType=2&pageIndex=1&plantId=771460&sequenceNum=9&showAddFlg=1\";\nmsg.method =  'GET';\nmsg.headers = {};\nmsg.headers['Content-Type']='application/x-www-form-urlencoded';\nmsg.payload = {};\n\nmsg.cookies = {};\nmsg.cookies = msg.responseCookies;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":240,"wires":[["5a26d7a8.20c228"]]},{"id":"ba4799d9.865038","type":"inject","z":"150a0205.bcdd1e","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":140,"y":80,"wires":[["8fc81aa8.9e1748"]]},{"id":"9d66eb97.d8049","type":"debug","z":"150a0205.bcdd1e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":990,"y":240,"wires":[]},{"id":"4d980b1a.6a9a84","type":"debug","z":"150a0205.bcdd1e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":620,"y":440,"wires":[]},{"id":"bbefd2d0.09547","type":"comment","z":"e69ba7ab.add3d8","name":"Leitura Medidor Nansen Chaves Consumo","info":"","x":200,"y":240,"wires":[]},{"id":"fd4f390e.7adff8","type":"mqtt in","z":"e69ba7ab.add3d8","name":"","topic":"medidornansen/consumo","qos":"0","datatype":"auto","broker":"9819de8a.09635","x":150,"y":400,"wires":[["ded2fb1e.315fa","d285c57b.edc58","82eb4cb1.e1b628","d1719c2b.eb701","4eedf753.483718","7f69c281.374c34"]]},{"id":"d82dc6d1.149a98","type":"mqtt out","z":"e69ba7ab.add3d8","name":"","topic":"medidornansen/leituras","qos":"2","retain":"true","broker":"9819de8a.09635","x":430,"y":140,"wires":[]},{"id":"62ba4cbe.fe84fc","type":"inject","z":"e69ba7ab.add3d8","name":"codigo_21_status","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"X","payloadType":"str","x":170,"y":120,"wires":[["d82dc6d1.149a98"]]},{"id":"e44ca5cc.5b351","type":"inject","z":"e69ba7ab.add3d8","name":"codigo_23_consumo","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"120","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"Y","payloadType":"str","x":180,"y":160,"wires":[["d82dc6d1.149a98"]]},{"id":"ded2fb1e.315fa","type":"debug","z":"e69ba7ab.add3d8","name":"msg_meter","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":350,"y":340,"wires":[]},{"id":"d285c57b.edc58","type":"ui_text","z":"e69ba7ab.add3d8","group":"7d2d7427.2def14","order":3,"width":0,"height":0,"name":"texto_meter","label":"text","format":"{{msg.payload}}","layout":"row-spread","x":350,"y":300,"wires":[]},{"id":"82eb4cb1.e1b628","type":"function","z":"e69ba7ab.add3d8","name":"separa energiaativatotal","func":"var mensagem =  msg.payload;\n\nvar leitura = Number(String(mensagem).substr(0, 10));\n\nmsg.payload = leitura*1.25;\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":450,"y":400,"wires":[["ec836bea.839438","506577a.16cbd88","7af9dafc.44858c"]]},{"id":"ec836bea.839438","type":"debug","z":"e69ba7ab.add3d8","name":"watts_consumo","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":720,"y":400,"wires":[]},{"id":"d1719c2b.eb701","type":"function","z":"e69ba7ab.add3d8","name":"separa Energia Reativa Indutiva","func":"var mensagem =  msg.payload;\n\nvar leitura = Number(String(mensagem).substr(12, 8));\n\nmsg.payload = leitura*1.25;\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":540,"wires":[["119bfb7b.02eee5","963316e5.301e18","729626e0.5fbbc8"]]},{"id":"119bfb7b.02eee5","type":"debug","z":"e69ba7ab.add3d8","name":"watts_reativo","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":710,"y":580,"wires":[]},{"id":"4eedf753.483718","type":"function","z":"e69ba7ab.add3d8","name":"separa Energia Reativa Capacitiva","func":"var mensagem =  msg.payload;\n\nvar leitura = Number(String(mensagem).substr(21, 9));\n\nmsg.payload = leitura*1.25;\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":680,"wires":[["8a1b4d5.acf273","dc8804a9.8e7028","84fed05a.2bad4"]]},{"id":"8a1b4d5.acf273","type":"debug","z":"e69ba7ab.add3d8","name":"watts_soma","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":710,"y":720,"wires":[]},{"id":"506577a.16cbd88","type":"ui_text","z":"e69ba7ab.add3d8","group":"3ca8e4a6.5e919c","order":1,"width":0,"height":0,"name":"Energia Ativa Total","label":"Energia Ativa Total","format":"{{msg.payload}} Wh","layout":"col-center","x":730,"y":440,"wires":[]},{"id":"963316e5.301e18","type":"ui_text","z":"e69ba7ab.add3d8","group":"3ca8e4a6.5e919c","order":2,"width":0,"height":0,"name":"Energia Reativa Indutiva","label":"Energia Reativa Indutiva","format":"{{msg.payload}} Var h","layout":"col-center","x":750,"y":540,"wires":[]},{"id":"dc8804a9.8e7028","type":"ui_text","z":"e69ba7ab.add3d8","group":"3ca8e4a6.5e919c","order":3,"width":0,"height":0,"name":"Energia Reativa Indutiva","label":" Energia Reativa Capacitiva","format":"{{msg.payload}} Var h","layout":"col-center","x":750,"y":680,"wires":[]},{"id":"7af9dafc.44858c","type":"function","z":"e69ba7ab.add3d8","name":"set global_EnergiaAtivaTotalChaves","func":"global.set(\"EnergiaAtivaTotalChaves\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":360,"wires":[[]]},{"id":"729626e0.5fbbc8","type":"function","z":"e69ba7ab.add3d8","name":"set global_ Energia Reativa Indutiva lChaves","func":"global.set(\"EnergiaReativaIndutivaChaves\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":500,"wires":[[]]},{"id":"84fed05a.2bad4","type":"function","z":"e69ba7ab.add3d8","name":"set global_Energia Reativa Capacitiva Chaves","func":"global.set(\"EnergiaReativaCapacitivaChaves\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":640,"wires":[[]]},{"id":"a123e862.5d5d28","type":"comment","z":"e69ba7ab.add3d8","name":"Variaveis, display e set global","info":"","x":780,"y":240,"wires":[]},{"id":"ef11c032.d4138","type":"comment","z":"e69ba7ab.add3d8","name":"MQTT consulta ao medidor em períodos","info":"","x":220,"y":80,"wires":[]},{"id":"986d3fe1.f592f","type":"debug","z":"e69ba7ab.add3d8","name":"resultado walter_ifsp_msyql","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1480,"y":860,"wires":[]},{"id":"f8161385.b38e58","type":"inject","z":"e69ba7ab.add3d8","name":"10min","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"120","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":100,"y":920,"wires":[["40d424df.0e84d4"]]},{"id":"58c32e44.207fb8","type":"function","z":"e69ba7ab.add3d8","name":"get_global_INSERT","func":"/// recupera variaveis\nvar  EnergiaAtivaTotalChaves =  global.get(\"EnergiaAtivaTotalChaves\");\nvar  EnergiaReativaIndutivaChaves = global.get(\"EnergiaReativaIndutivaChaves\");\nvar  EnergiaReativaCapacitivaChaves = global.get(\"EnergiaReativaCapacitivaChaves\");\nvar  producaomarcos = global.get(\"producaomarcos\");\nvar  potenciamarcos = global.get(\"potenciamarcos\");\n\nvar diferencaativatotal = global.get(\"diferencaativatotal\");\nvar diferencaativaindutiva = global.get(\"diferencaativaindutiva\");\nvar diferencareativacapacitiva = global.get(\"diferencareativacapacitiva\");\n\n\n\n\nmsg.topic = \"INSERT INTO energiaeletrica_chaves (ativatotal, dif_ativatotal, ativaindutiva, dif_ativaindutiva, reativacapacitiva, dif_reativacapacitiva,potenciainversor1, potenciainversor2, producaoinversor1, producaoinversor2 ) VALUES (\"+EnergiaAtivaTotalChaves+\",\"+diferencaativatotal+\",\"+EnergiaReativaIndutivaChaves+\",\"+diferencaativaindutiva+\", \"+EnergiaReativaCapacitivaChaves+\",0,\"+potenciamarcos+\",\"+diferencareativacapacitiva+\",\"+producaomarcos+\",0);\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":860,"wires":[["5642ede8.f790b4"]]},{"id":"8c67fb14.19131","type":"comment","z":"e69ba7ab.add3d8","name":"Grava Hidrometro em mysql","info":"","x":140,"y":820,"wires":[]},{"id":"5642ede8.f790b4","type":"mysql","z":"e69ba7ab.add3d8","mydb":"9bd5b51.93f96c8","name":"conexao_mysql_casa","x":1180,"y":860,"wires":[["986d3fe1.f592f"]]},{"id":"40d424df.0e84d4","type":"function","z":"e69ba7ab.add3d8","name":"SELECT","func":"msg.topic = \"SELECT ativatotal as ativatotal, ativaindutiva as ativaindutiva, reativacapacitiva as reativacapacitiva, time as time FROM energiaeletrica_chaves order by time DESC limit 1;\";\n\nreturn msg;\n\n// tabela campos ativatotal, dif_ativatotal, ativaindutiva, dif_ativaindutiva, reativacapacitiva, dif_reativacapacitiva,potenciainversor1, potenciainversor2, producaoinversor1, producaoinversor2\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":260,"y":920,"wires":[["76cf76f0.e5e78"]]},{"id":"76cf76f0.e5e78","type":"mysql","z":"e69ba7ab.add3d8","mydb":"9bd5b51.93f96c8","name":"conexao_mysql casa","x":460,"y":920,"wires":[["c692ae0a.149e68"]]},{"id":"c692ae0a.149e68","type":"function","z":"e69ba7ab.add3d8","name":"String_To_number","func":"\n\nvar  EnergiaAtivaTotalChaves =  global.get(\"EnergiaAtivaTotalChaves\");\nvar  EnergiaReativaIndutivaChaves = global.get(\"EnergiaReativaIndutivaChaves\");\nvar  EnergiaReativaCapacitivaChaves = global.get(\"EnergiaReativaCapacitivaChaves\");\n\n\nvar ativatotalanterior = { payload: msg.payload[0].ativatotal }\n\nvar ativaindutivaanterior = { payload: msg.payload[0].ativaindutiva }\n\nvar reativacapacitivaanterior = { payload: msg.payload[0].reativacapacitiva }\n\n\n\nvar diferencaativatotal = EnergiaAtivaTotalChaves - ativatotalanterior.payload;\nvar diferencaativaindutiva = EnergiaReativaIndutivaChaves - ativaindutivaanterior.payload;\nvar diferencareativacapacitiva = EnergiaReativaCapacitivaChaves -  reativacapacitivaanterior.payload;\n\n\n\ndiferencaativatotalp =          { payload : diferencaativatotal };\ndiferencaativaindutivap =       { payload : diferencaativaindutiva };\ndiferencareativacapacitivap =   { payload : diferencareativacapacitiva };\n\n\nglobal.set(\"diferencaativatotal\", diferencaativatotal);\nglobal.set(\"diferencaativaindutiva\", diferencaativaindutiva );\nglobal.set(\"diferencareativacapacitiva\", diferencareativacapacitiva );\n\nreturn [  diferencaativatotalp, diferencaativaindutivap, diferencareativacapacitivap ];\n\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":690,"y":900,"wires":[["c98d4dfc.38d858","58c32e44.207fb8"],["c98d4dfc.38d858"],["c98d4dfc.38d858"]]},{"id":"c98d4dfc.38d858","type":"debug","z":"e69ba7ab.add3d8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":910,"y":940,"wires":[]},{"id":"883f436a.abe368","type":"mqtt in","z":"e69ba7ab.add3d8","name":"","topic":"froniuschaves/edia","qos":"0","datatype":"auto","broker":"9819de8a.09635","x":150,"y":1060,"wires":[["4a86f700.fbdae8"]]},{"id":"221dd324.d810b4","type":"debug","z":"e69ba7ab.add3d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":490,"y":1080,"wires":[]},{"id":"4a86f700.fbdae8","type":"json","z":"e69ba7ab.add3d8","name":"","property":"payload","action":"","pretty":false,"x":330,"y":1060,"wires":[["221dd324.d810b4","f1b708d9.bd2f88"]]},{"id":"f1b708d9.bd2f88","type":"function","z":"e69ba7ab.add3d8","name":"","func":"global.set(\"producaomarcos\", msg.payload.producao);\nglobal.set(\"potenciamarcos\", msg.payload.potencia);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1040,"wires":[[]]},{"id":"d815cec1.533cf","type":"inject","z":"e69ba7ab.add3d8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":1340,"wires":[["e8f0e107.6749b8"]]},{"id":"e8f0e107.6749b8","type":"function","z":"e69ba7ab.add3d8","name":"SELECT","func":"msg.topic = \"SELECT dif_ativatotal as ativatotal, dif_ativaindutiva as ativaindutiva, dif_reativacapacitiva as reativacapacitiva, time as time FROM energiaeletrica_chaves order by time DESC limit 720;\";\n\nreturn msg;\n\n//msg.topic = \"SELECT * FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"SELECT temperature as temperatura, humidity as humidade, timeStamp FROM tempLog where timeStamp >= now() - 84600;\"\n\n//msg.topic = \"INSERT INTO tempLog (temperature,humidity) VALUES (\"+temperatura+\",\"+humidade+\" );\"\n\n//SELECT MAX(\"producaocatanduva\") as producao, time FROM \"Solar_IFSP\"  WHERE time >= now() - 30d GROUP BY time(1d)","outputs":1,"noerr":0,"initialize":"","finalize":"","x":310,"y":1340,"wires":[["6faa5dbe.4e6164"]]},{"id":"701d6eea.f5bf8","type":"comment","z":"e69ba7ab.add3d8","name":"Mysql: Select últimos 10 dados para grafico e tabela","info":"","x":230,"y":1300,"wires":[]},{"id":"38cd36e0.a447a2","type":"ui_chart","z":"e69ba7ab.add3d8","name":"Consumo elétrcia","group":"816beda9.4c1558","order":1,"width":14,"height":8,"label":"Ativa Total/Indutiva","chartType":"line","legend":"true","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"300","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":890,"y":1260,"wires":[[]]},{"id":"6faa5dbe.4e6164","type":"mysql","z":"e69ba7ab.add3d8","mydb":"9bd5b51.93f96c8","name":"conexao_mysql","x":490,"y":1340,"wires":[["e027c931.bf468","8e2a2a29.f98008","c17b6984.1ce67","4c1f7305.1b9f44"]]},{"id":"28cc259a.aa8502","type":"comment","z":"e69ba7ab.add3d8","name":"Leitura fronius","info":"","x":150,"y":1020,"wires":[]},{"id":"861ab6d4.c4c048","type":"ui_text","z":"e69ba7ab.add3d8","group":"3ca8e4a6.5e919c","order":4,"width":0,"height":0,"name":"Hora Msg","label":"Hora:","format":"{{msg.payload}} ","layout":"col-center","x":700,"y":300,"wires":[]},{"id":"7f69c281.374c34","type":"function","z":"e69ba7ab.add3d8","name":"hora","func":"var dateNow = new Date();\nvar timeAsString = dateNow.toLocaleTimeString();\n    \nmsg.payload = timeAsString + '.';\n                  \nreturn msg;\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":260,"wires":[["861ab6d4.c4c048"]]},{"id":"bbd4d4a2.38d618","type":"ui_chart","z":"e69ba7ab.add3d8","name":"Consumo elétrcia","group":"816beda9.4c1558","order":1,"width":14,"height":8,"label":"Ativa Indutiva ","chartType":"line","legend":"true","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":910,"y":1340,"wires":[[]]},{"id":"e027c931.bf468","type":"debug","z":"e69ba7ab.add3d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":740,"y":1180,"wires":[]},{"id":"8e2a2a29.f98008","type":"change","z":"e69ba7ab.add3d8","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t    {  \"label\": \"ativa total  (W)\", \"field\": \"ativatotal\" },\t    {  \"label\": \"ativa indutiva (W)\", \"field\": \"ativaindutiva\" }\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":710,"y":1260,"wires":[["38cd36e0.a447a2"]]},{"id":"c17b6984.1ce67","type":"change","z":"e69ba7ab.add3d8","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t    {  \"label\": \"ativa indutiva (W)\", \"field\": \"ativaindutiva\" },\t    {  \"label\": \"reativa capacitiva  (W)\", \"field\": \"reativacapacitiva\" }\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":710,"y":1340,"wires":[["bbd4d4a2.38d618"]]},{"id":"7024c8f8.51cff8","type":"ui_chart","z":"e69ba7ab.add3d8","name":"Consumo elétrcia","group":"816beda9.4c1558","order":1,"width":14,"height":8,"label":"Ativa Indutiva ","chartType":"line","legend":"true","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#00e68c","#2d2da8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":890,"y":1420,"wires":[[]]},{"id":"4c1f7305.1b9f44","type":"change","z":"e69ba7ab.add3d8","name":"Format data","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t  $series := [\t\t    {  \"label\": \"reativa capacitiva  (W)\", \"field\": \"reativacapacitiva\" }\t  ];\t  $xaxis := \"time\";\t  [\t    {\t      \"series\": $series.label,\t      \"data\": $series.[\t        (\t          $yaxis := $.field;\t          $$.payload.{\t            \"x\": $lookup($, $xaxis),\t            \"y\": $lookup($, $yaxis)\t          }\t        )\t      ]\t    }\t  ]\t)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":1420,"wires":[["7024c8f8.51cff8"]]}]